!function(j){"use strict";var w="ht",c=j[w],D=function(){return document},x=function(){return D().body},e=function(J,u,m){J.style.setProperty(u,m,null)},k=function(w){return D().createElement(w)},W=function(){return k("div")},r=function(){var D=k("canvas");return D},N=function(u,m){e(u,"-webkit-transform",m),e(u,"-ms-transform",m),e(u,"transform",m)},t=function(Y,q){e(Y,"-webkit-transform-origin",q),e(Y,"-ms-transform-origin",q),e(Y,"transform-origin",q)},M=function(Q,M){Q.appendChild(M)},V=function(A,T){A.removeChild(T)},P=j.parseInt,h=c.Default,z=h.getInternal(),y=Math.PI,O="white-space",B="visibility",U="left",n="top",L="width",p="height",u="position",Z="display",g="z-index",Q="px",H="0 0",m="absolute",E="visible",Y="hidden",$="none",q="block",G="nowrap",v="rgba(0, 0, 0, 0.005)";h.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var o=c.graph.GraphView.prototype,R=o._42;o.adjustHtmlNodeIndex=!0,o._42=function(A,s){if(R.call(this,A,s),this.adjustHtmlNodeIndex)for(var M=this.getDataModel()._datas._as,x=M.length,F=1,a=0;x>a;a++){var l=M[a];if(l instanceof d){var Z=this.getDataUI(l);e(Z.$2f,g,F+""),e(Z.$3f,g,F+1+""),F+=2}}};var K=c.HtmlNodeUI=function(A,E){var j=this;K.superClass.constructor.call(j,A,E);var i=j.$2f=W(),c=j.$3f=r();e(i,u,m),e(i,B,Y),e(i,O,G),c.draggable=!1,e(c,u,m),e(c,Z,$),t(c,H),i.addEventListener("change",function(q){var h=q.target,V=h.bind||h.getAttribute("bind"),B=h.type&&"checkbox"===h.type?h.checked:h.value,G=E.getContext();V&&G&&(G[V]=B,j.$4f=JSON.stringify(G))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(U){i.addEventListener(U,this.$9f.bind(this))},j)};h.def(K,z.ui().NodeUI,{_visible:!0,$11f:function(){var x=this,g=x.$3f,I=x._data,y=I.getDraggerImageWidth(),J=I.getDraggerImageHeight(),p=I.getDraggerImage(),$=z.initContext(g);$.beginPath(),z.setCanvas(g,y,J),z.translateAndScale($,0,0,1),$.clearRect(0,0,y,J),h.drawImage($,h.getImage(p),0,0,y,J),$.restore()},_80o:function(c){K.superClass._80o.call(this,c);var J=this,V=J._data,O=V._padding,z=2*O,i=J.$2f,G=J.$3f,r=J.gv,R=r.getZoom(),j=r.getTranslateX(),x=r.getTranslateY(),o=r.getView(),T=J._83o,A=V._width,d=V._height,t=T.position,b=T.rotation,F=(A-z)/V.$5f*R,H=(d-z)/V.$6f*R,f=J._html,C=V._html,h=V.getHtmlType();if("html"===h){var l=V.getContext()||{},k=J.$4f,S=V.$10f,D=JSON.stringify(l);f&&k&&f===C&&k===D||(J.$4f=D,J._html=C,i.innerHTML=S?S(l):C)}else if(null!=h){var s=V.getHtml();"ht"===h&&(s=s.getView()),f&&f===s&&i.contains(f)||(J._html=s,i.innerHTML="",M(i,s))}if(!i.parentNode){var w=r.$1f;if(!w){var I=W();e(I,u,m),e(I,g,"0"),w=r.$1f=I;var a=r._canvas.nextSibling;a?o.insertBefore(I,a):M(o,I)}M(w,i),M(w,G),V.onContentInitialized&&V.onContentInitialized(i)}if(V._scalable){var X=V.$5f,_=V.$6f;N(i,"rotate("+180*(b/y)+"deg) scale("+F+","+H+")"),e(i,L,""),e(i,p,""),e(i,U,(t.x-X/R/2)*R+j+Q),e(i,n,(t.y-_/R/2)*R+x+Q)}else{var Id=P(i.style.width),zo=P(i.style.height),Gj=P((A-z)*R),Km=P((d-z)*R),sq="100%",Wb=i.children[0];e(Wb,L,sq),e(Wb,p,sq),(Id!==Gj||zo!==Km)&&(e(i,L,Gj+Q),e(i,p,Km+Q),"ht"===h&&C.invalidate()),N(i,"rotate("+180*(b/y)+"deg)"),e(i,U,(t.x-Gj/R/2)*R+j+Q),e(i,n,(t.y-Km/R/2)*R+x+Q)}var $j=J.dragRect;r.isMovable(V)&&r.isSelected(V)&&$j?(c.save(),c.fillStyle=v,c.fillRect($j.x,$j.y,$j.width,$j.height),c.restore(),e(G,U,$j.x*R+j+Q),e(G,n,$j.y*R+x+Q),N(G,"scale("+R+","+R+")"),e(G,Z,q),J.$11f()):e(G,Z,$),e(i,B,this._visible?E:Y)},dispose:function(){var v=this.gv.$1f;this.$2f.parentNode===v&&v.removeChild(this.$2f),this.$3f.parentNode===v&&v.removeChild(this.$3f)},_84o:function(P){this._visible=P,e(this.$2f,B,P?E:Y),e(this.$3f,Z,P?q:$)},_3O:function(){var Z=this,l=Z.gv,Q=Z._data;K.superClass._3O.call(Z);var p=Q.getRect();l.isEditable(Q)&&(Z.dragRect={x:p.x+p.width+Q._padding,y:p.y+10,width:Q.getDraggerImageWidth(),height:Q.getDraggerImageHeight()},Z._68o(Z.dragRect))},rectIntersects:function(y){var b=this._79o();return c.Default.intersection(b,y)?!0:void 0},$9f:function(p){var k=this.gv,e=this._data;k.sm().contains(e)&&p.stopPropagation()}});var d=c.HtmlNode=function(){d.superClass.constructor.call(this)};c.Default.def(d,c.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:c.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(N){var w=this,O=w._html;w._html=N,"html"===w.getHtmlType()&&"Handlebars"in j&&(w.$10f=Handlebars.compile(N)),w.$13f(),w.fp("html",O,N)},setContext:function(C){var D=this,r=D._context;D._context=C,D.fp("context",r,C),D.$13f()},setScalable:function(g){var v=this,Y=v._scalable;v._scalable=g,v.fp("scalable",Y,g),v.$13f()},getHtmlType:function(){var J=this._html;return J?"string"==typeof J?"html":J.getView?"ht":"dom":null},$13f:function(){var $=this,J=$._html,X=$.$10f;if(J){var y=W(),H=!1,b=$.getHtmlType();if(e(y,u,m),e(y,O,G),e(y,B,Y),"html"===b?(y.innerHTML=X?X($.getContext()||{}):J,H=!0):"ht"===b?(M(y,J.getView()),H=!0):"dom"===b&&(M(y,J),H=!0),H){var C=2*$._padding;M(x(),y),$.$5f=y.scrollWidth,$.$6f=y.scrollHeight,$._width=$.$5f+C,$._height=$.$6f+C,$._originWidth=$._width,$._originHeight=$._height,V(x(),y)}}},getUIClass:function(){return c.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);