!function(d,Z,I){"use strict";var N="ht",s=d[N],V=s.Default,U=s.graph,J=V.getInternal(),R=J.ui(),T=R.NodeUI.prototype,b=R.ShapeUI.prototype,A=U.GraphView,l=A.prototype,o=R.EdgeUI.prototype,q=s.Node,f=s.Shape,r=s.Edge,k=s.Group,B=V.isTouchable,h=V.preventDefault,z=d.setTimeout,$=V.grow,M=V.isDragging,P=V.getDistance,_=null,y=s.List,K="undefined"!=typeof Float32Array?Float32Array:Array,c=Math,a=c.PI,e="Crossing",H="No Crossing",E=a/2,w=2*a,v=c.atan2,F=c.sqrt,O=c.pow,u=c.sin,D=c.cos,p=c.min,m=c.max,g=c.abs,G=c.ceil,n=c.round,j=V.unionPoint,L=V.unionRect,W=V.containsPoint,Q=V.clone,X="rgb(52, 152, 219)",t="red",C={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},Y={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var L=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],l=0;l<L.length;l++){var d=L[l];d=0===l%2?d/400*Y.width:d/100*Y.height,L[l]=d}return Y.width>120&&(L[4]=Y.width-26,L[6]=Y.width-40,L[10]=Y.width-40,L[12]=Y.width-26,L[18]=33),L}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},i={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:X,rotation:.61},{type:"circle",rect:[200,120,70,70],background:X,rotation:.61},{type:"circle",rect:[200,220,70,70],background:X,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:X},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:X}]},x={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:t,rotation:.61}]},S={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:X},{type:"circle",rect:[0,210,90,90],background:X},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:X}]},pj={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:t},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:t}]},jj={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:X}]},nl={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:t}]},Rf={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},vm={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Eg=function(U){var l=U.touches[0];return l?l:U.changedTouches[0]},ui=function(b,p,y,R){return v(R-p,y-b)},Dk=function(m,U){return{x:m.x*U,y:m.y*U}},Vp=function(S,_){S.each(function(o){return S.isSelected(o)?_(o):void 0})},lg=function(G,I){G.reverseEach(function(H){return G.isSelected(H)?I(H):void 0})},yp=function(k,$,b){var Z,I,W,R,z,E=this,H=$,l=E.gv;if(k instanceof f){W=k.getSegments();var B=l.getDataUI(k);z=B._55O.$15l,W&&W.size()||(W=Tj(z)),k.isClosePath()&&W.indexOf(5)<0&&(W=new y(W._as),W.add(5)),Z=lk(k,B,H),I=z[Z]}else{var s=l.getDataUI(k);z=sl(s,k.s("edge.points")),W=k.s("edge.segments"),W&&W.size()||(W=Tj(z)),z=z._as,Z=lk(k,s,H),I=z[Z]}if(W&&(R=W.get(H)),2===R||1===R||5===R){var U=z[Z+1];5===R&&(U=z[0]);var X=Kh(I,b,U);return X}return b},vf=function(e,P,s,C){var z=P/2,$=s/2,j=as(e,-z,-$,C),J=as(e,z,-$,C),b=as(e,-z,$,C),E=as(e,z,$,C),k=as(e,0,-$,C),q=as(e,z,0,C),g=as(e,0,$,C),d=as(e,-z,0,C);return[j,J,b,E,k,q,g,d]},Kh=function(x,$,l){var W={x:$.x-x.x,y:$.y-x.y},q={x:l.x-x.x,y:l.y-x.y},d=F(O(l.x-x.x,2)+O(l.y-x.y,2)),B={x:q.x/d,y:q.y/d},c=W.x*B.x+W.y*B.y,p={x:B.x*c,y:B.y*c};return{x:x.x+p.x,y:x.y+p.y}},as=function(A,H,t,F){var k=D(F)*H-u(F)*t,e=u(F)*H+D(F)*t;return A?{x:A.x+k,y:A.y+e}:{x:k,y:e}},so=function(R,T){return T>2*R?R:T/2},Fq=function(d,i,o,D){var E=P(d,i);return o=D?p(o,E):so(o,E),E?o/=E:o=0,{x:d.x+(i.x-d.x)*o,y:d.y+(i.y-d.y)*o}},ii=function(u,e){var m,i,Y=u.gv,x=u._data,z=x._40I,G=x._41I,Q=x.s("edge.offset"),s=x.s("edge.source.position"),W=x.s("edge.target.position"),l=x.s("edge.source.offset.x"),k=x.s("edge.source.offset.y"),V=x.s("edge.target.offset.x"),b=x.s("edge.target.offset.y"),T=x.s("edge.source.anchor.x"),D=x.s("edge.source.anchor.y"),K=x.s("edge.target.anchor.x"),w=x.s("edge.target.anchor.y");if(e?(m=J.getEdgeAgentPosition(Y,z,s,l,k,T,D),i=J.getEdgeAgentPosition(Y,G,W,V,b,K,w)):(m=J.getEdgeAgentPosition(Y,z,s,0,0,T,D),i=J.getEdgeAgentPosition(Y,G,W,0,0,K,w)),"points"===x.s("edge.type")&&Q&&!x.s("edge.center")&&m){var H=x.s("edge.points")||new y,h=H.size(),q=Fq(m,h?H.get(0):i,Q,h),d=Fq(i,h?H.get(h-1):m,Q,h);m=q,i=d}return[m,i]},sl=function(J,Z,O){var S=J._78o,P=J._data,R=P.s("edge.type"),b=[S.sourcePoint,S.targetPoint];return"points"===R?O&&(b=ii(J)):b=S.center?R?O?ii(J):ii(J,!0):O?ii(J):[S.c1,S.c2]:O?ii(J):ii(J,!0),Z=new y(Z?Z._as:_),Z.add(b[0],0),Z.add(b[1]),Z},Yk=function(R){return R=new y(R._as),R.removeAt(0),R.removeAt(R.size()-1),R},Tj=function(o){o._as||(o=new y(o));var O=new y;O.add(1);for(var t=1;t<o.size();t++)O.add(2);return O},Ci=function(R,U){return{x:(R.x+U.x)/2,y:(R.y+U.y)/2}},Ak=function(T,b){return{x:T.x+1*(b.x-T.x)/4,y:T.y+1*(b.y-T.y)/4}},We=function(o,S){return{x:o.x+3*(S.x-o.x)/4,y:o.y+3*(S.y-o.y)/4}},ul=function(K,g,H,J){var C=g.x+g.width/2,X=g.y+g.height/2,V=F(C*C+X*X),O=v(X,C)+H;return{x:J.x+V*D(O),y:J.y+V*u(O)}},Uf=l.validateImpl,Zh=l.isRectEditable,jo=l.isPointEditable,Wf=l._42,Rn=b._79o,Mf=o._79o,vk=b._48O,Ui=b._47O,Ye=T._48O,Pf=T._80o,un=b._80o,ol=T.getSelectWidth,Ym=T._47O,ig=o._47O,In=l.isEditable,uf=["northwest","north","northeast","east","southeast","south","southwest","west"],fb=function(P,l,X,D,b,G,d,M,z,S){var k=P.x,J=P.y,L=P.width,Z=P.height,E={x:k+L/2,y:J+Z/2};D=D||0,l=as(E,l.x-E.x,l.y-E.y,-D),d&&!M&&(l.x+=z,l.y+=S);var m=.01;if("northwest"===X?(l.x+b>k+L-m&&(l.x=k+L-b-m),l.y+b>J+Z-m&&(l.y=J+Z-b-m),P=j(l,{x:k+L,y:J+Z})):"north"===X?(l.y+b>J+Z-m&&(l.y=J+Z-b-m),P=j({x:k,y:l.y},{x:k+L,y:J+Z})):"northeast"===X?(l.x<k+b+m&&(l.x=k+b+m),l.y+b>J+Z-m&&(l.y=J+Z-b-m),P=j({x:k,y:l.y},{x:l.x,y:J+Z})):"west"===X?(l.x+b>k+L-m&&(l.x=k+L-b-m),P=j({x:l.x,y:J},{x:k+L,y:J+Z})):"east"===X?(l.x<k+b+m&&(l.x=k+b+m),P=j({x:k,y:J},{x:l.x,y:J+Z})):"southwest"===X?(l.x+b>k+L-m&&(l.x=k+L-b-m),l.y<J+b+m&&(l.y=J+b+m),P=j({x:l.x,y:J},{x:k+L,y:l.y})):"south"===X?(l.y<J+b+m&&(l.y=J+b+m),P=j({x:k,y:J},{x:k+L,y:l.y})):"southeast"===X&&(l.x<k+b+m&&(l.x=k+b+m),l.y<J+b+m&&(l.y=J+b+m),P=j({x:k,y:J},l)),"keepRatio"===G&&(!d&&M||d&&!M)&&("northeast"===X||"southeast"===X||"northwest"===X||"southwest"===X)){var v=P.width,w=P.height,T=v/L,q=w/Z,N=p(T,q);P.width=L*N,P.height=Z*N,"northeast"===X?P.y=J+(Z-P.height):"northwest"===X?(P.y=J+(Z-P.height),P.x=k+(L-P.width)):"southwest"===X&&(P.x=k+(L-P.width))}P.x-=E.x,P.y-=E.y;var I=ul(_,P,D,E);return P.x=I.x-P.width/2,P.y=I.y-P.height/2,P},Eb=function(Q,$,N,y){var Z=Q.getRotation(),F=$,H=F.x,_=F.y,k=F.width,x=F.height,d={x:H+F.width/2,y:_+F.height/2};y=as(d,y.x-d.x,y.y-d.y,-Z),"northwest"===N?F=j(y,{x:H+k,y:_+x}):"north"===N?F=j({x:H,y:y.y},{x:H+k,y:_+x}):"northeast"===N?F=j({x:H,y:y.y},{x:y.x,y:_+x}):"west"===N?F=j({x:y.x,y:_},{x:H+k,y:_+x}):"east"===N?F=j({x:H,y:_},{x:y.x,y:_+x}):"southwest"===N?F=j({x:y.x,y:_},{x:H+k,y:y.y}):"south"===N?F=j({x:H,y:_},{x:H+k,y:y.y}):"southeast"===N&&(F=j({x:H,y:_},y)),Q.setRect(F),F.x-=d.x,F.y-=d.y;var t=ul(Q,F,Z,d);Q.p(t.x,t.y)},Cp=function(e,R,W,z,S,P,k,m){var E=_;P?(E=as(_,S.x-R.x,S.y-R.y,-W),E.x-=k.x,E.y-=k.y):E=as(_,S.x-R.x,S.y-R.y,0);var T={x:R.x+E.x,y:R.y+E.y};m&&(T=m(T.x,T.y)),T.e=e.getPoints().get(z).e,e.setPoint(z,T);var b=e.getWidth(),N=e.getHeight(),X=e.p().x-b/2,o=e.p().y-N/2;X-=R.x,o-=R.y;var c=ul(e,{x:X,y:o,width:b,height:N},W,R);e.p(c.x,c.y)},lk=function(C,G,q){var m,k;if(C instanceof f?(m=C.getPoints(),k=C.getSegments()):C instanceof r&&"points"===C.s("edge.type")&&(m=C.s("edge.points"),k=C.s("edge.segments"),m=sl(G,m)),k&&k.size()||(k=Tj(m)),C instanceof f&&C.isClosePath()&&k.indexOf(5)<0&&(k=new y(k._as),k.add(5)),k)for(var n=-1,E=0;E<k.size();E++){if(E===q)return n;var H=k.get(E);1===H?n+=1:2===H?n+=1:3===H?n+=2:4===H&&(n+=3)}},Vr=function(u,S,l){var b,V;if(u instanceof f?(b=u.getPoints(),V=u.getSegments()):u instanceof r&&"points"===u.s("edge.type")&&(b=u.s("edge.points"),V=u.s("edge.segments"),b=sl(S,b)),V&&V.size()||(V=Tj(b)),V)for(var o=-1,Y=0;Y<V.size();Y++){var t=V.get(Y);if(1===t?o+=1:2===t?o+=1:3===t?o+=2:4===t&&(o+=3),o===l)return Y}},zf=function(w,k){var g=[w[0]-k[0],w[1]-k[1],w[2]-k[2]];return g},an=function(){var $=new K(16);return $[0]=1,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=1,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=1,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$},lr=function(O,Q){var K=O[0],Z=O[1],k=O[2];return O[0]=Q[0]*K+Q[4]*Z+Q[8]*k+Q[12],O[1]=Q[1]*K+Q[5]*Z+Q[9]*k+Q[13],O[2]=Q[2]*K+Q[6]*Z+Q[10]*k+Q[14],O},ve=function(B,U){if(U){var v=u(U),q=D(U),E=B[0],$=B[1],R=B[2],d=B[3],O=B[8],o=B[9],Q=B[10],V=B[11];B[0]=E*q-O*v,B[1]=$*q-o*v,B[2]=R*q-Q*v,B[3]=d*q-V*v,B[8]=E*v+O*q,B[9]=$*v+o*q,B[10]=R*v+Q*q,B[11]=d*v+V*q}},Ap=function(N,s){for(var Q=N.s("grid.row.count"),v=N.s("grid.column.count"),O=0;Q>O;O++)for(var A=0;v>A;A++){var U=N.getCellRect(O,A);if(W(U,s))return{rowIndex:O,columnIndex:A,rect:U,grid:N}}return null},_f=function(p,P,N,s,E,x){var K={},J=N-p,l=s-P,V=c.sqrt(J*J+l*l),I=J/V,Y=l/V,Z=(-p+E)*I+(-P+x)*Y;return 0>=Z?(K.x=p,K.y=P):Z>=V?(K.x=N,K.y=s):(K.x=p+Z*I,K.y=P+Z*Y),J=E-K.x,l=x-K.y,K.z=c.sqrt(J*J+l*l),K},xo=function(o,j){var C,m,f,Y,t,u,g,A,x=o.getPoints(),n=o.getSegments(),k=o.p(),Q=o.getRotation();if(!n||!(n.indexOf(3)>0||n.indexOf(4)>0)){for(A=0;A<=x.size()-1;A++)if(A===x.size()-1?(t=x.get(0),Y=x.get(A)):(Y=x.get(A),t=x.get(A+1)),Y=as(k,Y.x-k.x,Y.y-k.y,Q),t=as(k,t.x-k.x,t.y-k.y,Q),u=_f(Y.x,Y.y,t.x,t.y,j.x,j.y),g=u.z,g<(o.s("shape.border.width")||10)){m=Y,f=t,C=A;break}if(C!=_){var h=_f(m.x,m.y,f.x,f.y,j.x,j.y),e=P(m,h);return{attachIndex:C,attachOffset:e}}}},kq=function(g){for(var Z=g._data,t=Z.p(),y=Z.getRotation(),c=Z.getPoints(),u=_,o=[],B=0;B<c.size();B++)u=c.get(B),o.push(as(t,u.x-t.x,u.y-t.y,y));g._55O.$15l=o};V.setImage("xeditinteractor_parentIcon",i),V.setImage("xeditinteractor_hostIcon",x),V.setImage("xeditinteractor_edgeIcon",S),V.setImage("xeditinteractor_removeIcon",pj),V.setImage("xeditinteractor_sourceIcon",jj),V.setImage("xeditinteractor_targetIcon",nl),V.setImage("xeditinteractor_elevationIcon",Rf),V.setImage("xeditinteractor_tallIcon",vm),l._editPointSize=B?24:9,l._edgeHelpers=["parent","remove","source","target"],l._leftTopHelpers=["parent"],l._rightTopHelpers=["host"],l._leftBottomHelpers=["edge"],l._rightBottomHelpers=["remove"],uf=uf.concat(uf).concat(uf),o._79o=function(){var m=this,Y=m.gv,o=Y.getZoom(),R=Y._editInteractor,H=Mf.call(m);if(!H)return null;var a=ii(m,!0),I=a[0],z=a[1],h={x:H.x,y:H.y,width:H.width,height:H.height},n=j(I,z);if(R instanceof U.XEditInteractor){h=L(h,n);var D=m._55O,C=Y.getEditPointSize()/o+2,K=0;D&&D._43O&&(K+=C/2,$(h,K))}return h},o._47O=function(g){var p=this,N=p.gv,d=N._editInteractor;d instanceof U.XEditInteractor||ig.call(p,g)},o.rectIntersects=function(n){var x=this,R=x._data,i=x.gv,w=i.getZoom(),r=x._55O,G=i._editInteractor;if(G instanceof U.XEditInteractor&&i.isEditable(R)&&r&&r._43O&&"points"===R.s("edge.type")){var u=R.s("edge.points"),d=R.s("edge.segments");u=sl(x,u),d&&d.size()||(d=Tj(u)),u=u._as;var E=!1,h=B?5:1,q=n.x+h,f=n.y+h,L={x:q,y:f};if(G._edge===R&&G._hoverSegmentIndex>=0){var c=i._editInteractor._hoverSegmentIndex,v=d.get(c),p=lk(R,x,c),j=_;if(p!=_&&p>=0){var z=u[p],k=i.getSegmentHoverWidth()/w;if(2===v||1===v){var m=u[p+1];j=Hc(new mb(z.x,z.y),new mb(m.x,m.y),new mb(L.x-k,L.y-k),new mb(L.x+2*k,L.y+2*k)),j.$62l===e&&(E=!0)}else if(3===v){var $=u[p+1],m=u[p+2];j=Ef(new mb(z.x,z.y),new mb($.x,$.y),new mb(m.x,m.y),new mb(L.x-k,L.y-k),new mb(L.x+2*k,L.y+2*k)),j.$62l===e&&(E=!0)}else if(4===v){var T=u[p+1],t=u[p+2];m=u[p+3],j=Sj(new mb(z.x,z.y),new mb(T.x,T.y),new mb(t.x,t.y),new mb(m.x,m.y),new mb(L.x-k,L.y-k),new mb(L.x+2*k,L.y+2*k)),j.$62l===e&&(E=!0)}}}if(E)return!0}return _},b._47O=function(s){var V=this,y=V.gv,a=y._editInteractor;a instanceof U.XEditInteractor||Ui.call(V,s)},b.rectIntersects=function(M){var y=this,C=y._data,N=y.gv,L=N.getZoom(),o=y._55O,T=N._editInteractor;if(T instanceof U.XEditInteractor&&N.isEditable(C)&&o&&o._43O){var $=o.$15l,u=!1,x=B?5:1,j=M.x+x,t=M.y+x,a={x:j,y:t};if($&&$.length===C.getPoints().size()||(kq(y),$=o.$15l),T._shape===C&&T._hoverSegmentIndex>=0){var R=C.getSegments();R&&R.size()||(R=Tj($));var D=N._editInteractor._hoverSegmentIndex,h=R.get(D),w=lk(C,y,D),H=_;if(w!=_&&w>=0){var d=$[w],P=N.getSegmentHoverWidth()/L;if(2===h||1===h){var I=$[w+1];H=Hc(new mb(d.x,d.y),new mb(I.x,I.y),new mb(a.x-P,a.y-P),new mb(a.x+2*P,a.y+2*P)),H.$62l===e&&(u=!0)}else if(3===h){var Z=$[w+1],I=$[w+2];H=Ef(new mb(d.x,d.y),new mb(Z.x,Z.y),new mb(I.x,I.y),new mb(a.x-P,a.y-P),new mb(a.x+2*P,a.y+2*P)),H.$62l===e&&(u=!0)}else if(4===h){var g=$[w+1],f=$[w+2];I=$[w+3],H=Sj(new mb(d.x,d.y),new mb(g.x,g.y),new mb(f.x,f.y),new mb(I.x,I.y),new mb(a.x-P,a.y-P),new mb(a.x+2*P,a.y+2*P)),H.$62l===e&&(u=!0)}}}if(u)return!0}return _},b._48O=function(){var x=this,l=x.gv,k=l._editInteractor;k instanceof U.XEditInteractor?(T._48O.call(x),x._55O._43O&&kq(x)):vk.call(x)},b._79o=function(){var l=this,o=l.gv,t=o.getZoom(),r=o._editInteractor,S=Rn.call(l);if(S){var C={x:S.x,y:S.y,width:S.width,height:S.height};if(r instanceof U.XEditInteractor){var P=l._55O,s=o.getEditPointSize()/t+2,_=0;P&&P._43O&&(_+=s/2,$(C,_))}return C}},T._47O=function(T){var O=this,W=O.gv,A=W._editInteractor;if(A instanceof U.XEditInteractor);else{var q=O._55O;q&&q._98o&&Ym.call(O,T)}},T.getSelectWidth=function(){var E=this,N=E.gv,M=N._editInteractor,X=E._data;return N.isEditable(X)&&M instanceof U.XEditInteractor?0:ol.call(E)},T._80o=function(t){var O=this,z=O.gv._editInteractor;if(Pf.call(O,t),z&&z._debug){t.save(),t.beginPath(),t.lineWidth=1,t.strokeStyle="green";var q=O._79o();q&&(t.rect(q.x,q.y,q.width,q.height),t.stroke()),t.restore()}},b._80o=function(h){var P=this,E=P.gv._editInteractor;if(un.call(P,h),E&&E._debug){h.save(),h.beginPath(),h.lineWidth=1,h.strokeStyle="green";var l=P._79o();h.rect(l.x,l.y,l.width,l.height),h.stroke(),h.restore()}},T._48O=function(){var B=this,E=B.gv,R=B._data,Z=E._editInteractor,n=B._55O,i=R.p(),D=R.getRotation();if(Z instanceof U.XEditInteractor){if(n._42O){var Q=vf(i,R.getWidth(),R.getHeight(),D),G=Q[0],o=Q[1],j=Q[2],A=Q[3],C=Q[4],g=Q[5],X=Q[6],c=Q[7];n.$45l=[G,C,o,g,A,X,j,c]}}else Ye.call(B)},l.getResizeMode=function(){return this.$25l||"normal"},l.setResizeMode=function(e){var y=this.$25l;this.$25l=e,this.fp("resizeMode",y,e)},l.getSnapAngle=function(){return this.$26l||Math.PI/36},l.setSnapAngle=function(w){var x=this.$26l;this.$26l=w,this.fp("snapAngle",x,w)},l.getSnapSpacing=function(){return this.$27l},l.setSnapSpacing=function(J){var o=this.$27l;this.$27l=J,this.fp("snapSpacing",o,J)},l.getPointSnapSpacing=function(){return this._pointSnapSpacing},l.setPointSnapSpacing=function(F){var L=this._pointSnapSpacing;this._pointSnapSpacing=F,this.fp("pointSnapSpacing",L,F)},l.setHelperEditableFunc=function(H){var y=this._helperEditableFunc;this._helperEditableFunc=H,this.fp("helperEditableFunc",y,H)},l.getHelperEditableFunc=function(){return this._helperEditableFunc},l.setLeftTopHelpers=function(J){var I=this._leftTopHelpers;this._leftTopHelpers=J,this.fp("leftTopHelpers",I,J)},l.getLeftTopHelpers=function(){return this._leftTopHelpers},l.setLeftTopHelpersAlign=function(p){var O=this._leftTopHelpersAlign;this._leftTopHelpersAlign=p,this.fp("leftTopHelpersAlign",O,p)},l.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},l.setRightTopHelpers=function(M){var $=this._rightTopHelpers;this._rightTopHelpers=M,this.fp("rightTopHelpers",$,M)},l.getRightTopHelpers=function(){return this._rightTopHelpers},l.setRightTopHelpersAlign=function(K){var A=this._rightTopHelpersAlign;this._rightTopHelpersAlign=K,this.fp("rightTopHelpersAlign",A,K)},l.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},l.setLeftBottomHelpers=function(_){var P=this._leftBottomHelpers;this._leftBottomHelpers=_,this.fp("leftBottomHelpers",P,_)},l.getLeftBottomHelpers=function(){return this._leftBottomHelpers},l.setLeftBottomHelpersAlign=function(t){var r=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=t,this.fp("leftBottomHelpersAlign",r,t)},l.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},l.setRightBottomHelpers=function(l){var K=this._rightBottomHelpers;this._rightBottomHelpers=l,this.fp("rightBottomHelpers",K,l)},l.getRightBottomHelpers=function(){return this._rightBottomHelpers},l.setRightBottomHelpersAlign=function(g){var v=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=g,this.fp("rightBottomHelpersAlign",v,g)},l.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},l.setEdgeHelpers=function(h){var O=this._edgeHelpers;this._edgeHelpers=h,this.fp("edgeHelpers",O,h)},l.getEdgeHelpers=function(){return this._edgeHelpers},l.isHelperEditable=function(V,Z){return V instanceof r&&("host"===Z||"edge"===Z||"elevation"===Z||"tall"===Z)?!1:V instanceof q&&("source"===Z||"target"===Z)?!1:"pointElevation"===Z?this._helperEditableFunc?this._helperEditableFunc(V,Z):!1:this._helperEditableFunc?this._helperEditableFunc(V,Z):!0},l.getEditHelperSize=function(){return this._editHelperSize||(B?28:16)},l.setEditHelperSize=function(x){var b=this._editHelperSize;this._editHelperSize=x,this.fp("editHelperSize",b,x)},l.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},l.setEditRectBorderColor=function(j){var p=this.$28l;this.$28l=j,this.fp("editRectBorderColor",p,j)},l.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},l.setNodeBorderColor=function(f){var Y=this.$29l;this.$29l=f,this.fp("nodeBorderColor",Y,f)},l.getEditRectBorderStyle=function(){return this.$30l||"dashed"},l.setEditRectBorderStyle=function(y){var $=this.$30l;this.$30l=y,this.fp("editRectBorderStyle",$,y)},l.getControlPointBackground=function(){return this.$31l||"#ff0"},l.setControlPointBackground=function(T){var P=this.$31l;this.$31l=T,this.fp("controlPointBackground",P,T)},l.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},l.setControlPointBorderColor=function(f){var R=this.$32l;this.$32l=f,this.fp("controlPointBorderColor",R,f)},l.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},l.setJoinPointBackground=function(j){var T=this.$33l;this.$33l=j,this.fp("joinPointBackground",T,j)},l.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},l.setJoinPointBorderColor=function(M){var V=this.$34l;this.$34l=M,this.fp("joinPointBorderColor",V,M)},l.getDirectionLineColor=function(){return this.$35l||"#888"},l.setDirectionLineColor=function(a){var T=this.$35l;this.$35l=a,this.fp("directionLineColor",T,a)},l.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},l.setSegmentHoverColor=function(j){var t=this.$36l;this.$36l=j,this.fp("segmentHoverColor",t,j)},l.getSegmentHoverWidth=function(){return this.$22l||(B?16:8)},l.setSegmentHoverWidth=function(L){var K=this.$22l;this.$22l=L,this.fp("segmentHoverWidth",K,L)},l.getSnapPointBorderColor=function(){return this.$38l||"#f00"},l.setSnapPointBorderColor=function(I){var v=this.$38l;this.$38l=I,this.fp("snapPointBorderColor",v,I)},l.getEditRectPadding=function(){return this.$39l!=_?this.$39l:6},l.setEditRectPadding=function(Z){var y=this.$39l;this.$39l=Z,this.fp("editRectPading",y,Z)},l.isRectEditable=function(l){var j=this,O=j._editInteractor;return O instanceof U.XEditInteractor?j._rectEditableFunc?j._rectEditableFunc(l):!0:Zh.call(j,l)},l.isPointEditable=function(r){var I=this,C=I._editInteractor;return C instanceof U.XEditInteractor?I._pointEditableFunc?I._pointEditableFunc(r):!0:jo.call(I,r)},l.validateImpl=function(){var I=this,X=I.$14l,T=I._editInteractor;if(X){var z=I.getWidth(),Q=I.getHeight();(z!==X.clientWidth||Q!==X.clientHeight)&&(T&&(T._68I=1),J.setCanvas(X,z,Q),I._32I=1)}Uf.call(this)},l.isEditable=function(v){var D=In.call(this,v),O=this._editInteractor;if(O instanceof U.XEditInteractor&&v instanceof r){if(!v.s("2d.editable"))return!1;var F=this.getEditableFunc();D=F?F(v):!0}return D},l._42=function(j,y){var C=this,Z=C._editInteractor;Wf.call(C,j,y),Z instanceof U.XEditInteractor&&Z._68I&&Z._42()},l.isSnapPoint=function(){return!0};var _c=function(w){arguments.length>0&&this.$58l(w)},um=_c.prototype;um.$58l=function(S){this.$62l=S,this.points=new Array},um.$56l=function(t){this.points.push(t)},um.$57l=function(K){this.points=this.points.concat(K)};var mb=function(r,j){arguments.length>0&&this.$58l(r,j)},rb=mb.prototype;rb.$58l=function($,d){this.x=$,this.y=d},rb.add=function(y){return new mb(this.x+y.x,this.y+y.y)},rb.addEquals=function(Y){return this.x+=Y.x,this.y+=Y.y,this},rb.$55l=function(g){return new mb(this.x*g,this.y*g)},rb.eq=function(z){return this.x==z.x&&this.y==z.y},rb.lt=function(r){return this.x<r.x&&this.y<r.y},rb.lte=function(j){return this.x<=j.x&&this.y<=j.y},rb.gt=function(H){return this.x>H.x&&this.y>H.y},rb.gte=function(F){return this.x>=F.x&&this.y>=F.y},rb.lerp=function(G,D){return new mb(this.x+(G.x-this.x)*D,this.y+(G.y-this.y)*D)},rb.distanceFrom=function(Y){var R=this.x-Y.x,x=this.y-Y.y;return F(R*R+x*x)},rb.min=function(e){return new mb(p(this.x,e.x),p(this.y,e.y))},rb.max=function(f){return new mb(m(this.x,f.x),m(this.y,f.y))},rb.toString=function(){return this.x+","+this.y};var $b=function(){this.$58l(arguments)},gf=$b.prototype;$b.TO=1e-6,$b.AC=6,gf.$58l=function(h){this.co=new Array;for(var I=h.length-1;I>=0;I--)this.co.push(h[I])},gf.$55l=function(Z){for(var P=new $b,O=0;O<=this.$50l()+Z.$50l();O++)P.co.push(0);for(var O=0;O<=this.$50l();O++)for(var U=0;U<=Z.$50l();U++)P.co[O+U]+=this.co[O]*Z.co[U];return P},gf.$59l=function(){for(var J=this.$50l();J>=0&&g(this.co[J])<=$b.TO;J--)this.co.pop()},gf.$50l=function(){return this.co.length-1},gf.$51l=function(){var M;switch(this.$59l(),this.$50l()){case 0:M=new Array;break;case 1:M=this.$52l();break;case 2:M=this.$53l();break;case 3:M=this.$54l();break;case 4:M=this.$63l();break;default:M=new Array}return M},gf.$52l=function(){var T=new Array,R=this.co[1];return 0!=R&&T.push(-this.co[0]/R),T},gf.$53l=function(){var A=new Array;if(2==this.$50l()){var K=this.co[2],H=this.co[1]/K,p=this.co[0]/K,Q=H*H-4*p;if(Q>0){var T=F(Q);A.push(.5*(-H+T)),A.push(.5*(-H-T))}else 0==Q&&A.push(.5*-H)}return A},gf.$63l=function(){var l=new Array;if(4==this.$50l()){var P=this.co[4],h=this.co[3]/P,X=this.co[2]/P,D=this.co[1]/P,d=this.co[0]/P,u=new $b(1,-X,h*D-4*d,-h*h*d+4*X*d-D*D).$54l(),A=u[0],N=h*h/4-X+A;if(g(N)<=$b.TO&&(N=0),N>0){var e=F(N),$=3*h*h/4-e*e-2*X,G=(4*h*X-8*D-h*h*h)/(4*e),n=$+G,L=$-G;if(g(n)<=$b.TO&&(n=0),g(L)<=$b.TO&&(L=0),n>=0){var O=F(n);l.push(-h/4+(e+O)/2),l.push(-h/4+(e-O)/2)}if(L>=0){var O=F(L);l.push(-h/4+(O-e)/2),l.push(-h/4-(O+e)/2)}}else if(0>N);else{var G=A*A-4*d;if(G>=-$b.TO){if(0>G&&(G=0),G=2*F(G),$=3*h*h/4-2*X,$+G>=$b.TO){var t=F($+G);l.push(-h/4+t/2),l.push(-h/4-t/2)}if($-G>=$b.TO){var t=F($-G);l.push(-h/4+t/2),l.push(-h/4-t/2)}}}}return l},gf.$54l=function(){var E=new Array;if(3==this.$50l()){var R=this.co[3],z=this.co[2]/R,W=this.co[1]/R,Q=this.co[0]/R,p=(3*W-z*z)/3,n=(2*z*z*z-9*W*z+27*Q)/27,X=z/3,M=n*n/4+p*p*p/27,b=n/2;if(g(M)<=$b.TO&&(M=0),M>0){var C,s,U=F(M);C=-b+U,s=C>=0?O(C,1/3):-O(-C,1/3),C=-b-U,C>=0?s+=O(C,1/3):s-=O(-C,1/3),E.push(s-X)}else if(0>M){var H=F(-p/3),x=v(F(-M),-b)/3,K=D(x),G=u(x),q=F(3);E.push(2*H*K-X),E.push(-H*(K+q*G)-X),E.push(-H*(K-q*G)-X)}else{var C;C=b>=0?-O(b,1/3):O(-b,1/3),E.push(2*C-X),E.push(-C-X)}}return E};var ld=function(f,y){arguments.length>0&&this.$58l(f,y)},xk=ld.prototype;xk.$58l=function(R,r){this.x=R,this.y=r},xk.length=function(){return F(this.x*this.x+this.y*this.y)},xk.$60l=function(S){return this.x*S.x+this.y*S.y};var Sl=function(d,y,g,T){var E,a=(T.x-g.x)*(d.y-g.y)-(T.y-g.y)*(d.x-g.x),M=(y.x-d.x)*(d.y-g.y)-(y.y-d.y)*(d.x-g.x),i=(T.y-g.y)*(y.x-d.x)-(T.x-g.x)*(y.y-d.y);if(0!=i){var r=a/i,n=M/i;r>=0&&1>=r&&n>=0&&1>=n?(E=new _c(e),E.points.push(new mb(d.x+r*(y.x-d.x),d.y+r*(y.y-d.y)))):E=new _c(H)}else E=0==a||0==M?new _c("C"):new _c("P");return E},Dd=function(F,D,k,C,v){var Y,r,T,j,g,S,m,f=C.min(v),M=C.max(v),A=new _c(H);Y=D.$55l(-2),T=F.add(Y.add(k)),Y=F.$55l(-2),r=D.$55l(2),j=Y.add(r),g=new mb(F.x,F.y),m=new ld(C.y-v.y,v.x-C.x),S=C.x*v.y-v.x*C.y;for(var x=new $b(m.$60l(T),m.$60l(j),m.$60l(g)+S).$51l(),Q=0;Q<x.length;Q++){var c=x[Q];if(c>=0&&1>=c){var o=F.lerp(D,c),n=D.lerp(k,c),i=o.lerp(n,c);C.x==v.x?f.y<=i.y&&i.y<=M.y&&(A.$62l=e,A.$56l(i)):C.y==v.y?f.x<=i.x&&i.x<=M.x&&(A.$62l=e,A.$56l(i)):i.gte(f)&&i.lte(M)&&(A.$62l=e,A.$56l(i))}}return A},Ef=function(v,B,x,q,g){var D=q.min(g),r=q.max(g),p=new mb(r.x,D.y),J=new mb(D.x,r.y),a=Dd(v,B,x,D,p),M=Dd(v,B,x,p,r),U=Dd(v,B,x,r,J),b=Dd(v,B,x,J,D),z=new _c(H);return z.$57l(a.points),z.$57l(M.points),z.$57l(U.points),z.$57l(b.points),z.points.length>0&&(z.$62l=e),z},Jc=function(G,S,o,c,F,W){var I,k,q,p,Z,x,t,B,s,A,P=F.min(W),U=F.max(W),V=new _c(H);I=G.$55l(-1),k=S.$55l(3),q=o.$55l(-3),p=I.add(k.add(q.add(c))),Z=new ld(p.x,p.y),I=G.$55l(3),k=S.$55l(-6),q=o.$55l(3),p=I.add(k.add(q)),x=new ld(p.x,p.y),I=G.$55l(-3),k=S.$55l(3),q=I.add(k),t=new ld(q.x,q.y),B=new ld(G.x,G.y),A=new ld(F.y-W.y,W.x-F.x),s=F.x*W.y-W.x*F.y;for(var m=new $b(A.$60l(Z),A.$60l(x),A.$60l(t),A.$60l(B)+s).$51l(),i=0;i<m.length;i++){var Q=m[i];if(Q>=0&&1>=Q){var h=G.lerp(S,Q),l=S.lerp(o,Q),Y=o.lerp(c,Q),r=h.lerp(l,Q),L=l.lerp(Y,Q),R=r.lerp(L,Q);F.x==W.x?P.y<=R.y&&R.y<=U.y&&(V.$62l=e,V.$56l(R)):F.y==W.y?P.x<=R.x&&R.x<=U.x&&(V.$62l=e,V.$56l(R)):R.gte(P)&&R.lte(U)&&(V.$62l=e,V.$56l(R))}}return V},Sj=function(v,E,s,l,q,N){var O=q.min(N),A=q.max(N),C=new mb(A.x,O.y),m=new mb(O.x,A.y),u=Jc(v,E,s,l,O,C),U=Jc(v,E,s,l,C,A),W=Jc(v,E,s,l,A,m),_=Jc(v,E,s,l,m,O),J=new _c(H);return J.$57l(u.points),J.$57l(U.points),J.$57l(W.points),J.$57l(_.points),J.points.length>0&&(J.$62l=e),J},Hc=function(K,r,Z,X){var M=Z.min(X),U=Z.max(X),W=new mb(U.x,M.y),S=new mb(M.x,U.y),i=Sl(M,W,K,r),v=Sl(W,U,K,r),O=Sl(U,S,K,r),p=Sl(S,M,K,r),g=new _c(H);return g.$57l(i.points),g.$57l(v.points),g.$57l(O.points),g.$57l(p.points),g.points.length>0&&(g.$62l=e),g},_g=U.XEditInteractor=function(S){var G=this,v=G._view=document.createElement("canvas");v.className="editCanvas",v.style.position="absolute",_g.superClass.constructor.call(G,S)};V.def(_g,U.Interactor,{ms_edit:1,setUp:function(){var a=this,Q=a.gv,s=Q.getView(),q=a._view;_g.superClass.setUp.call(a),Q.setEditInteractor(a),Q.$14l=q,Q._79O?s.insertBefore(q,Q._79O):s.appendChild(q);var d=a.$49l=a.$11l.bind(a);Q.dm().md(d),Q.sm().ms(d),Q.mp(d)},tearDown:function(){var e=this,d=e.gv,$=d.getView(),l=e.$49l;_g.superClass.tearDown.call(e),d.setEditInteractor(_),d.$14l=_,$.removeChild(e._view),d.dm().umd(l),d.sm().ums(l),d.ump(l)},clear:function(){var P=this,U=P.gv;delete P._hoverSegmentIndex,delete P._edge,delete P._shape,delete U._editing,delete P.$10l,delete P.$13l,delete P.$9l,delete P._removePointIndex,delete P._lp,P.$12l="",delete P.$40l,delete P.$67l,delete P.$72l,delete P.$73l,delete P.$75l,delete P.$1l,delete P.$3l,delete P.$2l,delete P.$92l,delete P.$93l,delete P.$94l,P.clearDragging()},handle_keydown:function(D){this.$48l!==D.shiftKey&&(this.$48l=D.shiftKey,this.handle_mousemove(D,I,!0))},handle_keyup:function(R){this.$48l!==R.shiftKey&&(this.$48l=R.shiftKey,this.handle_mousemove(R,I,!0))},handle_touchstart:function(t){this.handle_mousemove(t),this.handle_mousedown(t)},handle_mousedown:function(T){h(T);var c=this,p=c.$13l,S=c.gv,G=S.dm(),F=S.sm(),X=S.getZoom(),A=S.lp(T),B=V.isDoubleClick(T),M=V.isLeftButton(T),y=c.$7l,E=c._shape,b=c._hoverSegmentIndex,H=c._edge,K=c.$87l,u=c.$88l,D=function(){c._68I||K===c.$87l&&u===c.$88l||c.$43l()};if(7!==c.$67l&&(delete c.$87l,delete c.$88l),M&&(E||H)&&b>=0&&B&&(E&&F.contains(E)||H&&F.contains(H))){var r=yp.call(c,E||H,b,A);return c.addShapePoint(E||H,b,r),z(function(){c.handle_mousemove(T)},40),void 0}if(M&&(E||H)&&c._removePointIndex>=0&&B)return c.removeShapePoint(),c.$5l=1,z(function(){c.handle_mousemove(T)},40),void 0;if(!M||!S._editing)return D(),void 0;if(E&&p>=0){var R=E.getPoints().get(p),n=E.p(),k=as(n,R.x-n.x,R.y-n.y,-y+E.getRotation());w=as(n,A.x-n.x,A.y-n.y,-y),c.$24l={x:w.x-k.x,y:w.y-k.y},c.startDragging(T),G.beginTransaction(),c.fi({kind:"beginEditPoint",event:T,data:E,index:p}),c.$88l=p,c.$87l=E}else if(c.$10l){var Y=S.sm().getSelection(),d=c.$6l,_=c.$1l={},W=c.$3l={},g=c.$16l[C[c.$10l]],j={x:d.x,y:d.y},s={x:d.x+d.width/2,y:d.y+d.height/2};c.$24l={x:A.x-g.x/X,y:A.y-g.y/X},c.$2l=Q(c.$8l),c.$4l=Q(d),Y.each(function(S){if(S instanceof q){var Z=S.p(),r=S.getWidth(),h=S.getHeight(),w=as(s,Z.x-s.x,Z.y-s.y,-y);_[S.getId()]={x:Z.x-r/2,y:Z.y-h/2,width:r,height:h},W[S.getId()]={x:(w.x-j.x)/d.width,y:(w.y-j.y)/d.height}}}),c.startDragging(T),G.beginTransaction(),c.fi({kind:"beginEditRect",event:T,direction:c.$10l})}else if(H&&p>=0){var O=sl(S.getDataUI(H),H.s("edge.points")),R=O.get(p);c.$24l={x:A.x-R.x,y:A.y-R.y},c.startDragging(T),G.beginTransaction(),c.fi({kind:"beginEditPoint",event:T,data:H,index:p}),c.$88l=p,c.$87l=H}else if(c.$40l){var d=c.$6l,s={x:d.x+d.width/2,y:d.y+d.height/2},i=Q(c.$23l);i.x/=X,i.y/=X;var x=as(s,i.x-s.x,i.y-s.y,-y),w=as(s,A.x-s.x,A.y-s.y,-y);c.$24l={x:w.x-x.x,y:w.y-x.y},c.startDragging(T),G.beginTransaction(),c.fi({kind:"beginEditRotation",event:T,data:c._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(c.$67l)>=0){var f=c.$67l;(7===f||8===f||9===f)&&G.beginTransaction(),c.startDragging(T)}else if(c.$71l&&B&&c.$79l(c.$71l,A)){var L=F.toSelection();G.beginTransaction(),L.each(function(k){G.remove(k)}),G.endTransaction()}D()},$11l:function(){var J=this,R=J.gv;R._editing&&(J.$13l==_||J._shape==_&&J._edge==_)&&(J.$73l==_||1!==J.$67l&&5!==J.$67l&&6!==J.$67l)||(J.$5l=1),J._68I=1},$46l:function(c){var k=this,G=k.gv,v=G.lp(c),m=[];return lg(G,function(E){var c=G.getDataUI(E);if(c){var s=c._79o();W(s,v)&&m.push(E)}}),m},$47l:function(s){var E=this,D=E.$13l,l=E.gv.dm();E.$10l?(E.fi({kind:"endEditRect",event:s,direction:E.$10l}),l.endTransaction()):E._shape&&D>=0?(E.fi({kind:"endEditPoint",event:s,data:E._shape,index:D}),l.endTransaction()):E._edge&&D>=0?(E.fi({kind:"endEditPoint",event:s,data:E._edge,index:D}),l.endTransaction()):E.$23l&&E.$40l&&(E.fi({kind:"endEditRotation",event:s}),l.endTransaction())},handleWindowTouchEnd:function(Z){this.handleWindowMouseUp(Z)},handleWindowMouseUp:function(D){var W=this,M=W.gv,E=M.dm(),w=W._shape,y=W._edge,d=W.$13l,j=W.$40l,o=W.$9l,t=W.$10l,i=W.$67l;if((w||y)&&d>=0&&o>=0){var e,v;if(w){var U=w.p(),L=w.getRotation();e=w.getPoints(),v=e.get(o),Cp(w,U,L,d,v,!1)}else if(e=sl(M.getDataUI(y),y.s("edge.points"),!0),v=e.get(o),0===d){var G=e.get(0);y.s("edge.source.offset.x",v.x-G.x),y.s("edge.source.offset.y",v.y-G.y)}else if(d===e.size()-1){var A=e.get(e.size()-1);y.s("edge.target.offset.x",v.x-A.x),y.s("edge.target.offset.y",v.y-A.y)}else"points"===y.s("edge.type")&&(e.set(d,v),y.s("edge.points",Yk(e)))}W.$47l(D);var V=W.$73l;1===i?(E.beginTransaction(),V?M.sm().each(function(F){if(F.setHost&&M.isHelperEditable(F,"host")){F.setHost(V);
var T=W.$75l,Q=W.$74l;T&&(F.s("attach.row.index",T.rowIndex),F.s("attach.column.index",T.columnIndex)),Q&&(F.s("attach.index",Q.attachIndex),F.s("attach.offset",Q.attachOffset),F.s("attach.offset.relative",!1),F.s("attach.offset.opposite",!1))}}):M.sm().each(function(S){S.setHost&&M.isHelperEditable(S,"host")&&(S.setHost(_),S.s("attach.row.index",I),S.s("attach.column.index",I),S.s("attach.index",I),S.s("attach.offset",I),S.s("attach.offset.relative",!1),S.s("attach.offset.opposite",!1))}),E.endTransaction()):2===i?(E.beginTransaction(),V?M.sm().each(function(i){i.setParent&&M.isHelperEditable(i,"parent")&&i.setParent(V)}):M.sm().each(function(X){X.setParent&&M.isHelperEditable(X,"parent")&&X.setParent(_)}),E.endTransaction()):3===i?V&&(E.beginTransaction(),M.sm().each(function(Y){if(M.isHelperEditable(Y,"edge")&&Y instanceof q&&V instanceof q){var r=new s.Edge;E.add(r),r.setSource(Y),r.setTarget(V),W.onEdgeCreated&&W.onEdgeCreated(D,r)}}),E.endTransaction()):5===i||6===i?V&&(E.beginTransaction(),M.sm().each(function(p){p instanceof r&&V instanceof q&&(5===i&&M.isHelperEditable(p,"source")?p.setSource(V):6===i&&M.isHelperEditable(p,"source")&&p.setTarget(V))}),E.endTransaction()):(7===i||8===i||9===i)&&E.endTransaction(),(t||j)&&W.$43l(!0),B?(W.clear(),delete W.$64l,W._68I||W.$43l()):(W.handle_mousemove(D,!0),i&&!W._68I&&W.$43l())},handleWindowTouchMove:function(e){this.handleWindowMouseMove(e)},handleWindowMouseMove:function(Z){this._78I(Z)},handle_mousemove:function(A,H,w){if(!this._pause){if(!w){var Q=B?Eg(A):A;this.$61l={clientX:Q.clientX,clientY:Q.clientY}}if(H===!0||!M()){var s=this,l=s.gv,d=!1,Z=_;s.clear(),l.sm().size()>0&&(Z=l.lp(w?s.$61l:A),d=s._79I(A,Z)),d&&(l._editing=1),s.$12l!==s.$65l&&(s.$65l=s.$12l,s.setCursor(s.$12l)),s.$40l!==s.$64l&&(s.$64l=s.$40l,s._68I||s.$43l()),s._hoverSegmentIndex!==s.$66l&&(s.$66l=s._hoverSegmentIndex,s._68I||s.$43l())}}},_78I:function(o){this.autoScroll(o);var c=this,K=c.gv,O=K.lp(o),X=K.getZoom(),W=c.$13l;if((c._shape||c._edge)&&W>=0){var y,N,C,h=c._shape,u=c._edge,x=c.$24l,T=K.getPointSnapSpacing(),S=function(i,d){return T==_||isNaN(T)?{x:i,y:d}:{x:n(i/T)*T,y:n(d/T)*T}};if(h){y=h.getPoints();var Y=h.p(),U=h.getRotation(),t=0;N=as(Y,O.x-Y.x,O.y-Y.y,-U),Cp(h,Y,U,W,O,!0,x,S),c.fi({kind:"betweenEditPoint",event:o,data:h,index:W})}else if(u){y=sl(K.getDataUI(u),u.s("edge.points"),!0),O.x-=x.x,O.y-=x.y,N=O;var l,I,L=u.s("edge.offset"),B=y.size(),s=B>2;if(0===W){var j=y.get(0);L&&(j=Fq(j,y.get(1),-L,s),O=Fq(O,y.get(1),-L,s)),l=O.x-j.x,I=O.y-j.y,C=S(l,I),u.s("edge.source.offset.x",C.x),u.s("edge.source.offset.y",C.y)}else if(W===B-1){var A=y.get(B-1);L&&(A=Fq(A,y.get(B-2),-L,s),O=Fq(O,y.get(B-2),-L,s)),l=O.x-A.x,I=O.y-A.y,C=S(l,I),u.s("edge.target.offset.x",C.x),u.s("edge.target.offset.y",C.y)}else"points"===u.s("edge.type")&&(C=S(O.x,O.y),C.e=y.get(W).e,y.set(W,C),u.s("edge.points",Yk(y)));c.fi({kind:"betweenEditPoint",event:o,data:u,index:W})}if(delete c.$9l,K.isSnapPoint(h)||K.isSnapPoint(u))for(t=0;t<y.size();t++)if(t!==W){var D=y.get(t);if(P(D,N)<K.getEditPointSize()/X){c.$9l=t;break}}}else if(c.$10l){var x=c.$24l;O.x-=x.x,O.y-=x.y;var R=K.sm().getSelection(),M=c.$1l,i=c.$7l,J=c.$10l,e=c.$4l,Q=c.$2l,d=K.getEditRectPadding()/X,G=2*d,b=K.getSnapSpacing(),m=b!=_&&!isNaN(b),Z=fb(Q,O,J,i,2*d,K.getResizeMode(),m,!0),k=c.$6l;if(m){var H=Z.width-G,p=Z.height-G,$=n(H/b)*b,Lr=n(p/b)*b,Yd=$-H,Zi=Lr-p;("west"===J||"northwest"===J||"southwest"===J)&&(Yd=-Yd),("north"===J||"northwest"===J||"northeast"===J)&&(Zi=-Zi),Z=fb(Q,O,J,i,2*d,K.getResizeMode(),m,!1,Yd,Zi)}c.$8l=Z,k.x=Z.x+d,k.y=Z.y+d,k.width=Z.width-G,k.height=Z.height-G;var ck=Z.x+Z.width/2,Db=Z.y+Z.height/2,Sk=k.x,is=k.y,vi=k.width/e.width,qn=k.height/e.height;R.each(function(X){if(X instanceof q&&K.isEditable(X)&&K.isRectEditable(X)){var x=M[X.getId()],n=c.$3l[X.getId()],w={x:x.x+x.width/2,y:x.y+x.height/2},j=0,L=0,e=J,N=180*g(i-X.getRotation())/a;"northeast"===J?N>=315||45>N?(j=x.width*vi+x.x,L=x.height*(1-qn)+x.y,e="northeast"):N>=45&&135>N?(j=x.width*(1-qn)+x.x,L=x.height*(1-vi)+x.y,e="northwest"):N>=135&&225>N?(j=x.width*(1-vi)+x.x,L=x.height*qn+x.y,e="southwest"):(j=x.width*qn+x.x,L=x.height*vi+x.y,e="southeast"):"north"===J?N>=315||45>N?(L=x.height*(1-qn)+x.y,e="north"):N>=45&&135>N?(j=x.width*(1-qn)+x.x,e="west"):N>=135&&225>N?(L=x.height*qn+x.y,e="south"):(j=x.width*qn+x.x,e="east"):"northwest"===J?N>=315||45>N?(j=x.width*(1-vi)+x.x,L=x.height*(1-qn)+x.y,e="northwest"):N>=45&&135>N?(j=x.width*(1-qn)+x.x,L=x.height*vi+x.y,e="southwest"):N>=135&&225>N?(j=x.width*vi+x.x,L=x.height*qn+x.y,e="southeast"):(j=x.width*qn+x.x,L=x.height*(1-vi)+x.y,e="northeast"):"west"===J?N>=315||45>N?(j=x.width*(1-vi)+x.x,e="west"):N>=45&&135>N?(L=x.height*vi+x.y,e="south"):N>=135&&225>N?(j=x.width*vi+x.x,e="east"):(L=x.height*(1-vi)+x.y,e="north"):"southwest"===J?N>=315||45>N?(j=x.width*(1-vi)+x.x,L=x.height*qn+x.y,e="southwest"):N>=45&&135>N?(j=x.width*qn+x.x,L=x.height*vi+x.y,e="southeast"):N>=135&&225>N?(j=x.width*vi+x.x,L=x.height*(1-qn)+x.y,e="northeast"):(j=x.width*(1-qn)+x.x,L=x.height*(1-vi)+x.y,e="northwest"):"east"===J?N>=315||45>N?(j=x.width*vi+x.x,e="east"):N>=45&&135>N?(L=x.height*(1-vi)+x.y,e="north"):N>=135&&225>N?(j=x.width*(1-vi)+x.x,e="west"):(L=x.height*vi+x.y,e="south"):"south"===J?N>=315||45>N?(L=x.height*qn+x.y,e="south"):N>=45&&135>N?(j=x.width*qn+x.x,e="east"):N>=135&&225>N?(L=x.height*(1-qn)+x.y,e="north"):(j=x.width*(1-qn)+x.x,e="west"):"southeast"===J&&(N>=315||45>N?(j=x.width*vi+x.x,L=x.height*qn+x.y,e="southeast"):N>=45&&135>N?(j=x.width*qn+x.x,L=x.height*(1-vi)+x.y,e="northeast"):N>=135&&225>N?(j=x.width*(1-vi)+x.x,L=x.height*(1-qn)+x.y,e="northwest"):(j=x.width*(1-qn)+x.x,L=x.height*vi+x.y,e="southwest"));var F=as(w,j-w.x,L-w.y,X.getRotation());Eb(X,x,e,{x:F.x,y:F.y});var S=Sk+k.width*n.x,u=is+k.height*n.y,s={x:S,y:u};s=as({x:ck,y:Db},s.x-ck,s.y-Db,i),X.p(s.x,s.y)}}),c.fi({kind:"betweenEditRect",event:o,direction:J})}else if(c.$23l&&c.$40l){var lk=c.$8l,Gh=lk.width,iq=lk.height,Y={x:lk.x+Gh/2,y:lk.y+iq/2},x=c.$24l,sr=c.$23l,Dn=sr.x/X-Y.x,ys=sr.y/X-Y.y,Jn=F(Dn*Dn+ys*ys),zi=Math.asin(x.x/Jn),Cm=K.sm().getSelection(),kl=E+v(O.y-Y.y,O.x-Y.x)-zi,bl=K.getSnapAngle(),kl=n(kl/bl)*bl;0>kl&&(kl+=w);var ad=kl-c.$7l,Nn=[Y.x,0,Y.y];Cm.each(function(O){if(K.isEditable(O)&&K.isRotationEditable(O)&&K.isVisible(O)){var q=zf(O.p3(),Nn),k=an();ve(k,-ad),O.setRotation(O.getRotation()+ad),lr(q,k),O.p3(Nn[0]+q[0],Nn[1]+q[1],Nn[2]+q[2])}}),c.$7l=kl,c.fi({kind:"betweenEditRotation",event:o})}else if([1,2,3,5,6].indexOf(c.$67l)>=0)c.$72l=o,c.$78l||(c.$78l=1,z(function(){V.isDragging()&&c.$43l(),delete c.$78l},12));else if(7===c.$67l){if(c.$87l instanceof f){var h=c.$87l,yr=c.$88l,Zr=V.clone(h.getPoints().get(yr)),Th=O.y-Zr.y;Zr.e||(Zr.e=0),c.$92l||(c.$92l=Zr.e),Zr.e=c.$92l-Th,h.setPoint(yr,Zr)}else if(c.$87l instanceof r){var u=c.$87l,yr=c.$88l,y=sl(K.getDataUI(u),u.s("edge.points")),Zr=y.get(yr),Th=O.y-Zr.y;Zr.e||(Zr.e=0),c.$92l||(c.$92l=Zr.e),Zr.e=c.$92l-Th,y.set(yr,Zr),u.s("edge.points",Yk(y))}}else if(8===c.$67l){var Cm=K.sm().getSelection(),Pr=c.$93l;Pr||(Pr=c.$93l={}),Cm.each(function(R){if(R.p3){var T=R.p3(),L=Pr[R.getId()];L==_&&(L=Pr[R.getId()]=T[1]),R.p3([T[0],L-(O.y-c.$90l.y/X),T[2]])}})}else if(9===c.$67l){var Cm=K.sm().getSelection(),pb=c.$94l;pb||(pb=c.$94l={}),Cm.each(function(Y){if(Y.s3){var f=Y.s3(),P=pb[Y.getId()];P==_&&(P=pb[Y.getId()]=f[1]);var p=P-(O.y-c.$91l.y/X);0>p&&(p=.01),Y.s3([f[0],p,f[2]])}})}},$79l:function(y,X){var d=this,r=d.gv,j=r.getZoom(),A=r.getEditHelperSize(),c=y.x/j,u=y.y/j,n=A/j,v=n/2;return W({x:c-v,y:u-v,width:n,height:n},X)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(a,Y){for(var I=this,Z=I.gv,T=Z.getZoom(),M=Z.getEditPointSize(),J=M/T,y=J/2,X=I.$46l(a),D=0;D<X.length;D++){var t,S,$=X[D],_=Z.getDataUI($);if(_&&_._55O){var d=_._55O;if(d._43O&&$ instanceof r){if(t=$.s("edge.points"),t=sl(_,t),S=$.s("edge.segments"),S&&S.size()||(S=Tj(t)),I.$42l($,Y,t._as,S,"edge"))return!0;if("points"===$.s("edge.type"))return I.$41l($,Y,t._as,S,"edge"),void 0}if(d._43O&&$ instanceof f&&d.$15l&&d.$15l.length===$.getPoints().size()){if(t=d.$15l,S=$.getSegments(),S&&S.size()||(S=Tj(t)),I.$42l($,Y,t,S,"shape"))return!0;if(I.$41l($,Y,t,S,"shape"))return}}}if(I.$16l){var t,P=I.$16l,j=P[3].x-P[7].x,E=P[3].y-P[7].y,c=F(j*j+E*E),R=P[1].x-P[5].x,x=P[1].y-P[5].y,w=F(R*R+x*x),Q={x:Y.x*T,y:Y.y*T};if(I._80I(Q,0,P[0],"northwest",c,w)||I._80I(Q,1,P[1],"north",c,w)||I._80I(Q,2,P[2],"northeast",c,w)||I._80I(Q,7,P[7],"west",c,w)||I._80I(Q,3,P[3],"east",c,w)||I._80I(Q,6,P[6],"southwest",c,w)||I._80I(Q,5,P[5],"south",c,w)||I._80I(Q,4,P[4],"southeast",c,w))return!0}if(I.$23l){var V=I.$23l,q=V.x/T,G=V.y/T;if(W({x:q-y,y:G-y,width:J,height:J},Y))return I.$40l=1,I.$12l=I.getHelperCursor("rotation")||"crosshair",!0}return I.$68l&&I.$79l(I.$68l,Y)?(I.$67l=1,I.$12l=I.getHelperCursor("host")||"crosshair",!0):I.$69l&&I.$79l(I.$69l,Y)?(I.$67l=2,I.$12l=I.getHelperCursor("parent")||"crosshair",!0):I.$70l&&I.$79l(I.$70l,Y)?(I.$67l=3,I.$12l=I.getHelperCursor("edge")||"crosshair",!0):I.$71l&&I.$79l(I.$71l,Y)?(I.$67l=4,I.$12l=I.getHelperCursor("remove")||"crosshair",!0):I.$82l&&I.$79l(I.$82l,Y)?(I.$67l=5,I.$12l=I.getHelperCursor("source")||"crosshair",!0):I.$83l&&I.$79l(I.$83l,Y)?(I.$67l=6,I.$12l=I.getHelperCursor("target")||"crosshair",!0):I._pointElevationHelperPoint&&I.$79l(I._pointElevationHelperPoint,Y)?(I.$67l=7,I.$12l=I.getHelperCursor("pointElevation")||"crosshair",!0):I.$90l&&I.$79l(I.$90l,Y)?(I.$67l=8,I.$12l=I.getHelperCursor("elevation")||"crosshair",!0):I.$91l&&I.$79l(I.$91l,Y)?(I.$67l=9,I.$12l=I.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(k,o,M,m,P,V){var g=this,T=g.gv,D=T.getEditPointSize(),K=D/2,B=T.sm(),L=T.isDirectionEditable;if(L&&1===B.size()){var x=B.ld();if(L=L.bind(T),x instanceof q){if(!L(x,m))return!1;if("east"===m){if(L(x,"northeast")&&L(x,"southeast")&&2*D>=V)return!1}else if("west"===m){if(L(x,"northwest")&&L(x,"southwest")&&2*D>=V)return!1}else if("north"===m){if(L(x,"northwest")&&L(x,"northeast")&&2*D>=P)return!1}else if("south"===m&&L(x,"southwest")&&L(x,"southeast")&&2*D>=P)return!1}}else{if(2*D>=P&&("north"===m||"south"===m))return!1;if(2*D>=V&&("east"===m||"west"===m))return!1}if(W({x:M.x-K,y:M.y-K,width:D,height:D},k)){if(g.$10l!==m){var p=180*g.$7l/a,u="";p>=337.5||22.5>p?u="north":p>=22.5&&67.5>p?u="northeast":p>=67.5&&112.5>p?u="east":p>=112.5&&157.5>p?u="southeast":p>=157.5&&202.5>p?u="south":p>=202.5&&247.5>p?u="southwest":p>=247.5&&292.5>p?u="west":p>=292.5&&337.5>p&&(u="northwest");var r=uf.indexOf(u),u=uf[o-(1-r)+8];switch(u){case"northwest":g.$12l="nwse-resize";break;case"northeast":g.$12l="nesw-resize";break;case"southwest":g.$12l="nesw-resize";break;case"southeast":g.$12l="nwse-resize";break;case"north":g.$12l="ns-resize";break;case"east":g.$12l="ew-resize";break;case"south":g.$12l="ns-resize";break;case"west":g.$12l="ew-resize"}g.$10l=m}return!0}return!1},$42l:function(H,g,S,G,X){var K,r=this,P=r.gv,M=P.getEditPointSize(),x=M/P.getZoom(),d=-1,u={x:g.x,y:g.y,width:0,height:0},v=function(x){"shape"===X?r._shape=H:r._edge=H,r._removePointIndex=x},O=function(i){"shape"===X?r._shape=H:r._edge=H,r.$13l=i,r.$12l="crosshair"};for($(u,x/2),d=S.length-1,K=G.size()-1;K>=0;K--){var s=G.get(K);if(1===s||2===s)d-=1;else if(3===s){var B=S[d-1];if(W(u,B))return O(d-1),!0;d-=2}else if(4===s){var I=S[d-1],m=S[d-2];if(W(u,I))return O(d-1),!0;if(W(u,m))return O(d-2),!0;d-=3}}for(d=S.length-1,K=G.size()-1;K>=0;K--){var s=G.get(K),Q=S[d];if(W(u,Q))return v(d),O(d),!0;1===s||2===s?d-=1:3===s?d-=2:4===s&&(d-=3)}return!1},$41l:function(h,b,R,v,z){var D=this,P=D.gv,x=-1,A=0,q={x:b.x,y:b.y,width:0,height:0},k=function(W,e){D._hoverSegmentIndex=e,D._lp=b,"shape"===z?D._shape=h:D._edge=h};for($(q,P.getSegmentHoverWidth()/2/P.getZoom()),h instanceof f&&h.isClosePath()&&v.indexOf(5)<0&&(v=new y(v._as),v.add(5));A<v.size();A++){var a=v.get(A);if(1===a){var M=R[x],E=R[x+1];if(M){var W=Hc(new mb(M.x,M.y),new mb(E.x,E.y),new mb(q.x,q.y),new mb(q.x+q.width,q.y+q.height));if(W.$62l===e&&W.points.length>0)return k(W,A),!0}x+=1}else if(2===a){var M=R[x],E=R[x+1],W=Hc(new mb(M.x,M.y),new mb(E.x,E.y),new mb(q.x,q.y),new mb(q.x+q.width,q.y+q.height));if(W.$62l===e&&W.points.length>0)return k(W,A),!0;x+=1}else if(3===a){var M=R[x],j=R[x+1],i=R[x+2],W=Ef(new mb(M.x,M.y),new mb(j.x,j.y),new mb(i.x,i.y),new mb(q.x,q.y),new mb(q.x+q.width,q.y+q.height));if(W.$62l===e)return k(W,A),!0;x+=2}else if(4===a){var M=R[x],T=R[x+1],X=R[x+2],i=R[x+3],W=Sj(new mb(M.x,M.y),new mb(T.x,T.y),new mb(X.x,X.y),new mb(i.x,i.y),new mb(q.x,q.y),new mb(q.x+q.width,q.y+q.height));if(W.$62l===e)return k(W,A),!0;x+=3}else if(5===a){var M=R[x],E=R[0];if(M){var W=Hc(new mb(M.x,M.y),new mb(E.x,E.y),new mb(q.x,q.y),new mb(q.x+q.width,q.y+q.height));if(W.$62l===e&&W.points.length>0)return k(W,A),!0}}}return!1},addShapePoint:function(g,d,x){var Q=this,I=Q.gv,K=I.dm();if(K.beginTransaction(),0===arguments.length&&(g=Q._shape||Q._edge,d=Q._hoverSegmentIndex,x=Q._lp),g instanceof f||g instanceof r){var $=lk(g,I.getDataUI(g),d);if(!isNaN(d)&&x&&!isNaN($)){var W=x;if(g instanceof f){var o=g.p(),T=g.getRotation(),E=g.toSegments();E&&E.size()||(E=Tj(g.getPoints())),g.isClosePath()&&E.indexOf(5)<0&&(E=new y(E._as),E.add(5));var F=E.get(d),_="addPoint",a="removePointAt";if(2===F||1===F){var G={x:W.x,y:W.y};E.add(F,d),G=as(o,G.x-o.x,G.y-o.y,-T),g[_](G,$+1)}else if(3===F){var H=g.getPoints(),N=H.get($),j=H.get($+2),G={x:W.x,y:W.y};G=as(o,G.x-o.x,G.y-o.y,-T);var w=Ci(N,G),L=Ci(G,j);E.removeAt(d),E.add(3,d),E.add(3,d),g.setPoint($+1,G),g[_](L,$+2),g[_](w,$+1)}else if(4===F){var H=g.getPoints(),N=H.get($),j=H.get($+3),G={x:W.x,y:W.y};G=as(o,G.x-o.x,G.y-o.y,-T);var w=Ak(N,G),L=We(N,G),n=Ak(G,j),M=We(G,j);E.removeAt(d),E.add(4,d),E.add(4,d),g[a]($+1),g[a]($+1),g[_](G,$+1),g[_](M,$+2),g[_](n,$+2),g[_](L,$+1),g[_](w,$+1)}else if(5===F){var G={x:W.x,y:W.y};E.add(2,d),G=as(o,G.x-o.x,G.y-o.y,-T),g[_](G,$+1)}g.isClosePath()&&E.remove(5),g.setSegments(E);var e=g.getWidth(),b=g.getHeight(),c=g.p().x-e/2,l=g.p().y-b/2;c-=o.x,l-=o.y;var S=ul(g,{x:c,y:l,width:e,height:b},T,o);g.p(S.x,S.y)}else if(g instanceof r){if("points"!==g.s("edge.type"))return K.endTransaction(),void 0;var H=g.s("edge.points");E=g.s("edge.segments"),H=sl(I.getDataUI(g),H),E&&E.size()||(E=Tj(H)),E=new y(E._as.slice(0)),H=new y(H._as.slice(0));var F=E.get(d);if(2===F||1===F){var G={x:W.x,y:W.y};E.add(F,d),H.add(G,$+1)}else if(3===F){var N=H.get($),j=H.get($+2),G={x:W.x,y:W.y},w=Ci(N,G),L=Ci(G,j);E.removeAt(d),E.add(3,d),E.add(3,d),H.set($+1,G),H.add(L,$+2),H.add(w,$+1)}else if(4===F){var N=H.get($),j=H.get($+3),G={x:W.x,y:W.y},w=Ak(N,G),L=We(N,G),n=Ak(G,j),M=We(G,j);E.removeAt(d),E.add(4,d),E.add(4,d),H.removeAt($+1),H.removeAt($+1),H.add(G,$+1),H.add(M,$+2),H.add(n,$+2),H.add(L,$+1),H.add(w,$+1)}g.s("edge.points",Yk(H)),g.s("edge.segments",E)}}}K.endTransaction()},removeShapePoint:function(t,i){var g=this,z="removeAt",Y=g.gv,P=Y.dm();if(P.beginTransaction(),0===arguments.length&&(t=g._shape||g._edge,i=g._removePointIndex),i>=0&&(t instanceof f||t instanceof r)){var Q=Vr(t,g.gv.getDataUI(t),i),q=i;if(t instanceof f){var w=t.p(),R=t.toSegments();R&&R.size()||(R=Tj(t.getPoints()));var A=R.get(Q),W="removePointAt";if(1===A&&0===q)if(t.getPoints().size()>1){var U=R.get(Q+1);R[z](Q+1),3===U?t[W](q+1):4===U&&(t[W](q+2),t[W](q+1)),t[W](q)}else t.dm().remove(t);else 2===A||1===A?(R[z](Q),t[W](q)):3===A?(R[z](Q),t[W](q),t[W](q-1)):4===A&&(R[z](Q),t[W](q),t[W](q-1),t[W](q-2));t.setSegments(R);var C=t.getWidth(),h=t.getHeight(),N=t.p().x-C/2,I=t.p().y-h/2;N-=w.x,I-=w.y;var X=ul(t,{x:N,y:I,width:C,height:h},t.getRotation(),w);t.p(X.x,X.y)}else if(t instanceof r){if("points"!==t.s("edge.type"))return P.endTransaction(),void 0;var p=t.s("edge.points");if(R=t.s("edge.segments"),p&&(p=sl(g.gv.getDataUI(t),p),R&&R.size()||(R=Tj(p))),0===i||i===p.size()-1)return P.endTransaction(),void 0;R=new y(R._as.slice(0)),p=new y(p._as.slice(0));var A=R.get(Q);2===A||1===A?(R[z](Q),p[z](q)):3===A?(R[z](Q),p[z](q),p[z](q-1)):4===A&&(R[z](Q),p[z](q),p[z](q-1),p[z](q-2)),t.s("edge.segments",R),t.s("edge.points",Yk(p))}}P.endTransaction()},changeShapeSegment:function(M,U,G){var K=this,q=K.gv,L=q.dm();if(L.beginTransaction(),1!==arguments.length||isNaN(M)||(G=M,M=K._shape||K._edge,U=K._hoverSegmentIndex),M instanceof f||M instanceof r){var O=lk(M,K.gv.getDataUI(M),U);if(!isNaN(U)&&!isNaN(O))if(M instanceof f){var t=M.p(),x=M.toSegments();x&&x.size()||(x=Tj(M.getPoints()));var i=x.get(U),w=M.toPoints();if(1===G||2===G)1===i||2===i?x.set(U,G):3===i?(x.set(U,G),w.removeAt(O+1)):4===i&&(x.set(U,G),w.removeAt(O+1),w.removeAt(O+1));else if(3===G){var B=function(){var S=w.get(O),E=w.get(O+1),Y=Ci(S,E);x.set(U,3),w.add(Y,O+1)};2===i||1===i?B():4===i&&(w.removeAt(O+1),w.removeAt(O+1),B())}else if(4===G){var H=function(){var s=w.get(O),k=w.get(O+1),r=Ak(s,k),M=We(s,k);x.set(U,4),w.add(r,O+1),w.add(M,O+2)};2===i||1===i?H():3===i&&(w.removeAt(O+1),H())}M.setSegments(x),M.setPoints(w);var j=M.getWidth(),F=M.getHeight(),I=M.p().x-j/2,V=M.p().y-F/2;I-=t.x,V-=t.y;var N=new ul(M,{x:I,y:V,width:j,height:F},M.getRotation(),t);M.p(N.x,N.y)}else if(M instanceof r){if("points"!==M.s("edge.type"))return L.endTransaction(),void 0;var w=M.s("edge.points");x=M.s("edge.segments"),w&&(w=sl(K.gv.getDataUI(M),w),x&&x.size()||(x=Tj(w))),x=new y(x._as.slice(0)),w=new y(w._as.slice(0));var i=x.get(U);if(1===G||2===G)1===i||2===i?x.set(U,G):3===i?(x.set(U,G),w.removeAt(O+1)):4===i&&(x.set(U,G),w.removeAt(O+1),w.removeAt(O+1));else if(3===G){var B=function(){var v=w.get(O),n=w.get(O+1),p=Ci(v,n);x.set(U,3),w.add(p,O+1)};2===i||1===i?B():4===i&&(w.removeAt(O+1),w.removeAt(O+1),B())}else if(4===G){var H=function(){var H=w.get(O),t=w.get(O+1),a=Ak(H,t),k=We(H,t);x.set(U,4),w.add(a,O+1),w.add(k,O+2)};2===i||1===i?H():3===i&&(w.removeAt(O+1),H())}M.s("edge.points",Yk(w)),M.s("edge.segments",x)}}L.endTransaction()},getDefaultSegments:function(z){var B=this.gv,C=B.getDataUI(z);if(z instanceof r){var Q=z.s("edge.points");return Q=sl(C,Q),Tj(Q)}if(z instanceof f){var Q=z.getPoints(),q=z.getSegments();return q&&q.size()>0?q:Tj(Q)}},$43l:function(g){var X=this;g&&(X.$5l=1),X._68I=1,X._42()},_42:function(){var i=this;if(i._68I){delete i._68I;var x=i.gv,v=i.$5l,S=x.getZoom(),p=x.getEditPointSize(),D=p/2,c=new y,U=i._view,d=i._edge,M=i._shape,H=U.getContext("2d"),C=x.tx(),e=x.ty(),B=_,b=x.getEditPointBackground(),g=x.getControlPointBackground(),T=x.getControlPointBorderColor(),l=x.getEditPointBorderColor(),A=x.getEditRectBorderColor(),N=x.getDirectionLineColor(),W=x.getSegmentHoverColor(),Z=x.getSnapPointBorderColor(),a=x.getJoinPointBackground(),h=x.getJoinPointBorderColor(),O=x.getSegmentHoverWidth(),z=[5,5],u=x.getEditRectBorderStyle();Vp(x,function(w){x.isSelected(w)&&x.isVisible(w)&&c.add(w)}),H.clearRect(0,0,G(U.width),G(U.height)),H.save(),J.translateAndScale(H,C,e,1);var P=_,n={x:0,y:0,width:0,height:0},E=0,o=0,R=0,m=0,K=0,I=0,Sb=0,xd=0,Qg=0,Fg=0,wn=[];if(v?(delete i.$6l,delete i.$8l,delete i.$7l,delete i.$16l,delete i.$23l):(P=i.$6l,B=i.$7l),delete i.$68l,delete i.$69l,delete i.$71l,delete i.$70l,delete i.$82l,delete i.$83l,delete i._pointElevationHelperPoint,delete i.$90l,delete i.$91l,delete i.$75l,delete i.$74l,c.each(function(V){var j=x.getDataUI(V);if(j){var l=j._55O;if(x.isEditable(V))l._56O&&V instanceof q&&o++,wn.push(V),l._42O&&V instanceof q&&E++,x.isHelperEditable(V,"host")&&m++,x.isHelperEditable(V,"parent")&&R++,x.isHelperEditable(V,"remove")&&K++,x.isHelperEditable(V,"edge")&&I++,x.isHelperEditable(V,"source")&&Sb++,x.isHelperEditable(V,"target")&&xd++,x.isHelperEditable(V,"elevation")&&Qg++,x.isHelperEditable(V,"tall")&&Fg++;else if(V instanceof k&&V.isExpanded()){var _=!0,A=x.getEditableFunc();A&&(_=A(V)),_&&(x.isHelperEditable(V,"host")&&m++,x.isHelperEditable(V,"parent")&&R++,x.isHelperEditable(V,"remove")&&K++,x.isHelperEditable(V,"edge")&&I++,x.isHelperEditable(V,"source")&&Sb++,x.isHelperEditable(V,"target")&&xd++,x.isHelperEditable(V,"elevation")&&Qg++,x.isHelperEditable(V,"tall")&&Fg++,wn.push(V))}}}),H.beginPath(),H.lineWidth=1,H.strokeStyle=x.getNodeBorderColor(),wn.forEach(function(z){var U=x.getDataUI(z),R=U._55O;if(v)if(B==_&&(B=z instanceof r?0:z instanceof k&&z.isExpanded()?0:z.getRotation(),i.$7l=B),P==_){var s,J,W;if(z instanceof k&&z.isExpanded()||z instanceof r){var Y=x.getDataUIBounds(z);J=Y.width,W=Y.height,s={x:Y.x+J/2,y:Y.y+W/2}}else s=z.p(),J=z.getWidth(),W=z.getHeight();P={x:s.x,y:s.y,width:0,height:0},n.x=s.x-J/2,n.y=s.y-W/2,n.width=J,n.height=W,P=L(P,n)}else{var s,J,W,O,m=P.x+P.width/2,D=P.y+P.height/2,y={x:m,y:D};if(z instanceof k&&z.isExpanded()||z instanceof r){O=0;var Y=x.getDataUIBounds(z);J=Y.width,W=Y.height,s={x:Y.x+J/2,y:Y.y+W/2}}else s=z.p(),J=z.getWidth(),W=z.getHeight(),O=z.getRotation();var Q={x:s.x-J/2,y:s.y-W/2,width:J,height:W},T={x:Q.x,y:Q.y},G={x:Q.x+Q.width,y:Q.y},a={x:Q.x,y:Q.y+Q.height},t={x:Q.x+Q.width,y:Q.y+Q.height},T=as(s,T.x-s.x,T.y-s.y,O),a=as(s,a.x-s.x,a.y-s.y,O),t=as(s,t.x-s.x,t.y-s.y,O),G=as(s,G.x-s.x,G.y-s.y,O),I=-B,X=as(y,T.x-y.x,T.y-y.y,I),b=as(y,G.x-y.x,G.y-y.y,I),g=as(y,a.x-y.x,a.y-y.y,I),M=as(y,t.x-y.x,t.y-y.y,I),l=j([X,b,g,M]);P=L(P,l),P.x-=m,P.y-=D;var p=ul(_,P,B,y);P.x=p.x-P.width/2,P.y=p.y-P.height/2}if(E>1&&x.isEditable(z)&&x.isRectEditable(z)&&z instanceof q){var d=z.getRect(),h=R.$45l,Z=Dk(h[0],S),C=Dk(h[2],S),F=Dk(h[4],S),$=Dk(h[6],S);z.getRotation()?(H.moveTo(Z.x,Z.y),H.lineTo(C.x,C.y),H.lineTo(F.x,F.y),H.lineTo($.x,$.y),H.lineTo(Z.x,Z.y)):H.rect(d.x*S,d.y*S,d.width*S,d.height*S)}}),H.stroke(),P){i.$6l=Q(P),$(P,x.getEditRectPadding()/S);var Oo={x:P.x+P.width/2,y:P.y+P.height/2},Cm=vf(Oo,P.width,P.height,B),Hr=Cm[0],Sc=Cm[1],Om=Cm[2],ni=Cm[3],Fd=Cm[4],li=Cm[5],lg=Cm[6],nl=Cm[7];if(Hr=Dk(Cm[0],S),Sc=Dk(Cm[1],S),Om=Dk(Cm[2],S),ni=Dk(Cm[3],S),Fd=Dk(Cm[4],S),li=Dk(Cm[5],S),lg=Dk(Cm[6],S),nl=Dk(Cm[7],S),i.$8l=P,E>0&&(i.$16l=[Hr,Fd,Sc,li,ni,lg,Om,nl],H.beginPath(),H.lineWidth=1,H.strokeStyle=A,"dashed"===u&&H.setLineDash&&H.setLineDash(z),H.moveTo(Hr.x,Hr.y),H.lineTo(Sc.x,Sc.y),H.lineTo(ni.x,ni.y),H.lineTo(Om.x,Om.y),H.lineTo(Hr.x,Hr.y),H.stroke(),"dashed"===u&&H.setLineDash&&H.setLineDash([])),H.beginPath(),H.lineWidth=1,H.fillStyle=b,H.strokeStyle=l,E>0){var lf=li.x-nl.x,dl=li.y-nl.y,Ib=F(lf*lf+dl*dl),cg=Fd.x-lg.x,Tr=Fd.y-lg.y,ib=F(cg*cg+Tr*Tr),$m=2*p;if(x.isDirectionEditable&&1===wn.length){var sm=wn[0],_l=x.getDataUI(sm),jj=_l._55O,ih=x.isDirectionEditable.bind(x);if(jj._42O){var br,Jp,Dg,ti;ih(sm,"northwest")&&(br=!0,H.rect(Hr.x-D,Hr.y-D,p,p)),ih(sm,"northeast")&&(Jp=!0,H.rect(Sc.x-D,Sc.y-D,p,p)),ih(sm,"southwest")&&(Dg=!0,H.rect(Om.x-D,Om.y-D,p,p)),ih(sm,"southeast")&&(ti=!0,H.rect(ni.x-D,ni.y-D,p,p)),ih(sm,"north")&&(br&&Jp?Ib>$m&&H.rect(Fd.x-D,Fd.y-D,p,p):H.rect(Fd.x-D,Fd.y-D,p,p)),ih(sm,"south")&&(ti&&Dg?Ib>$m&&H.rect(lg.x-D,lg.y-D,p,p):H.rect(lg.x-D,lg.y-D,p,p)),ih(sm,"west")&&(Dg&&br?ib>$m&&H.rect(nl.x-D,nl.y-D,p,p):H.rect(nl.x-D,nl.y-D,p,p)),ih(sm,"east")&&(ti&&Jp?ib>$m&&H.rect(li.x-D,li.y-D,p,p):H.rect(li.x-D,li.y-D,p,p))}}else Ib>$m&&(H.rect(Fd.x-D,Fd.y-D,p,p),H.rect(lg.x-D,lg.y-D,p,p)),ib>$m&&(H.rect(li.x-D,li.y-D,p,p),H.rect(nl.x-D,nl.y-D,p,p)),H.rect(Hr.x-D,Hr.y-D,p,p),H.rect(Sc.x-D,Sc.y-D,p,p),H.rect(Om.x-D,Om.y-D,p,p),H.rect(ni.x-D,ni.y-D,p,p)}if(o>0){var iq=i.$23l=as(Fd,0,2*-p,B);H.moveTo(iq.x+D,iq.y),H.arc(iq.x,iq.y,D,0,w,!1)}H.fill(),H.stroke(),i.$40l&&i.$44l(H,P,B);var qg,mi,gn=x.getLeftTopHelpers(),Sg=x.getRightTopHelpers(),Zc=x.getLeftBottomHelpers(),As=x.getRightBottomHelpers(),Xc=x.getEdgeHelpers(),$j=x.getEditHelperSize(),rj=$j/2,wd=function(g,J,$,f){"leftTop"===J?(qg=P.x*S-$j-D-("h"===f?$*($j+D):0)-1,mi=P.y*S-$j-D-("v"===f?$*($j+D):0)-1):"rightTop"===J?(qg=(P.x+P.width)*S+D+("h"===f?$*($j+D):0)+1,mi=P.y*S-$j-D-("v"===f?$*($j+D):0)-1):"leftBottom"===J?(qg=P.x*S-$j-D-("h"===f?$*($j+D):0)-1,mi=(P.y+P.height)*S+D+("v"===f?$*($j+D):0)+1):"rightBottom"===J&&(qg=(P.x+P.width)*S+D+("h"===f?$*($j+D):0)+1,mi=(P.y+P.height)*S+D+("v"===f?$*($j+D):0)+1);var T=qg+rj,W=mi+rj,M=(P.x+P.width/2)*S,O=(P.y+P.height/2)*S,V=as({x:M,y:O},T-M,W-O,B);if("host"===g){if(m>0)return i.$77l(H,B,V),!0}else if("edge"===g){if(I>0)return i.$80l(H,B,V),!0}else if("remove"===g){if(K>0)return wn&&1===wn.length&&wn[0]instanceof r?i.$81l(H,B,{x:M+$j/2+5,y:O}):i.$81l(H,B,V),!0}else if("parent"===g){if(R>0)return wn&&1===wn.length&&wn[0]instanceof r?i.$76l(H,B,{x:M-$j/2-5,y:O}):i.$76l(H,B,V),!0}else if("elevation"===g){if(Qg>0)return i.$85l(H,B,V),!0}else if("tall"===g){if(Fg>0)return i.$86l(H,B,V),!0}else if("source"===g||"target"===g){var s=wn[0],h=x.getDataUI(s),F=ii(h,!0),Z=F[0],l=F[1];if(Sb&&"source"===g)return i.$84l(H,P,Z,!0,s.isLooped(),J,$,f),!0;if(xd&&"target"===g)return i.$84l(H,P,l,!1,s.isLooped(),J,$,f),!0}};if(gn&&gn.length>0){var Jo=0;gn.forEach(function(v){wd(v,"leftTop",Jo,x.getLeftTopHelpersAlign()||"h")&&Jo++})}if(Sg&&Sg.length>0){var Jo=0;Sg.forEach(function(K){wd(K,"rightTop",Jo,x.getRightTopHelpersAlign()||"h")&&Jo++})}if(Zc&&Zc.length>0){var Jo=0;Zc.forEach(function(P){wd(P,"leftBottom",Jo,x.getLeftBottomHelpersAlign()||"h")&&Jo++})}if(As&&As.length>0){var Jo=0;As.forEach(function(X){wd(X,"rightBottom",Jo,x.getRightBottomHelpersAlign()||"h")&&Jo++})}if(Xc&&Xc.length>0&&((Sb||xd)&&wn&&1===wn.length&&wn[0]instanceof r?!0:!1)){var Jo=0;Xc.forEach(function(v){wd(v,"edge",Jo,"h")&&Jo++})}if(i.$72l){var cf,rm=i.$67l,Oe=i.$68l,Mn=i.$69l,be=(i.$71l,i.$70l),nm=i.$82l,nd=i.$83l;if(1===rm?cf=Oe:2===rm?cf=Mn:3===rm?cf=be:5===rm?cf=nm:6===rm&&(cf=nd),cf){var Cn=x.lp(i.$72l),dn=x.getDataAt(i.$72l);if(dn&&dn instanceof q){var gi,fi,Yr;if(i.$73l=dn,1===rm)if(dn instanceof s.Grid)gi=i.$75l=Ap(dn,Cn);else if(dn instanceof s.Shape){Yr=i.$74l=xo(dn,Cn);var Lf=dn.getPoints();if(Yr){var Dm=Yr.attachIndex,yh=lk(dn,x.getDataUI(dn),Dm)+1,ur=yh+1>=Lf.size()?0:yh+1,Ke=Lf.get(yh),up=Lf.get(ur),Wq=dn.p(),Xo=dn.getRotation();Ke=as(Wq,Ke.x-Wq.x,Ke.y-Wq.y,Xo),up=as(Wq,up.x-Wq.x,up.y-Wq.y,Xo),H.beginPath(),H.strokeStyle=W,H.lineWidth=O,H.moveTo(Ke.x*S,Ke.y*S),H.lineTo(up.x*S,up.y*S),H.stroke()}}gi?fi=gi.rect:(fi=V.clone(x.getDataUIBounds(dn)),V.grow(fi,2)),H.beginPath(),H.rect(fi.x*S,fi.y*S,fi.width*S,fi.height*S),H.strokeStyle=1===rm||4===rm||6===rm?t:X,H.lineWidth=2,H.setLineDash&&H.setLineDash([8,8]),H.stroke()}else delete i.$73l;Cn.x=Cn.x*S,Cn.y=Cn.y*S;var mq=ui(cf.x,cf.y,Cn.x,Cn.y),lh=as(cf,Cn.x-cf.x,Cn.y-cf.y,-mq),Zk=lh.x-cf.x;H.translate(cf.x,cf.y),H.rotate(mq),Y.width=Zk,Y.height=40;var Sk=X;(1===rm||4===rm||6===rm)&&(Sk=t),Y.comps[0].gradientColor=Sk,V.drawImage(H,Y,0,-20,Zk,40)}}}if(c.each(function(n){var V=x.getDataUI(n);if(V){var Q,k,P=V._55O,B=V._78o;if(P&&P._43O&&n instanceof f?(Q=P.$15l,k=n.getSegments(),k&&k.size()||(k=Tj(Q)),n.isClosePath()&&k.indexOf(5)<0&&(k=new y(k._as),k.add(5))):P&&B&&P._43O&&(Q=n.s("edge.points"),k=n.s("edge.segments"),Q=sl(V,Q),k&&k.size()||(k=Tj(Q)),Q&&(Q=Q._as)),Q&&k){var I=0,F=k.size(),X=i._hoverSegmentIndex;Q=Q.slice(0);for(var L=0;L<Q.length;L++)Q[L]=Dk(Q[L],S);H.beginPath(),H.strokeStyle=N,H.lineWidth=1,I=0;for(var L=0;F>L;L++){var s=k.get(L);if(1===s||2===s)I++;else if(3===s){var G=Q[I-1],p=Q[I],u=Q[I+1];H.moveTo(G.x,G.y),H.lineTo(p.x,p.y),H.lineTo(u.x,u.y),I+=2}else if(4===s){var G=Q[I-1],j=Q[I],r=Q[I+1],u=Q[I+2];H.moveTo(G.x,G.y),H.lineTo(j.x,j.y),H.moveTo(r.x,r.y),H.lineTo(u.x,u.y),I+=3}}if(H.stroke(),M===n||d===n&&"points"===d.s("edge.type")){H.beginPath(),I=0,H.strokeStyle=W,H.lineWidth=O;for(var L=0;F>L;L++){var s=k.get(L);if(1===s||2===s){if(X===L){var G=Q[I-1],u=Q[I];H.moveTo(G.x,G.y),H.lineTo(u.x,u.y);break}I++}else if(3===s){if(X===L){var G=Q[I-1],p=Q[I],u=Q[I+1];H.moveTo(G.x,G.y),H.quadraticCurveTo(p.x,p.y,u.x,u.y);break}I+=2}else if(4===s){if(X===L){var G=Q[I-1],j=Q[I],r=Q[I+1],u=Q[I+2];H.moveTo(G.x,G.y),H.bezierCurveTo(j.x,j.y,r.x,r.y,u.x,u.y);break}I+=3}else if(5===s&&X===L){var G=Q[I-1],u=Q[0];H.moveTo(G.x,G.y),H.lineTo(u.x,u.y);break}}H.stroke()}H.beginPath(),I=0,H.strokeStyle=h,H.lineWidth=1,H.fillStyle=a;for(var L=0;F>L;L++){var s=k.get(L);if(1===s||2===s){var u=Q[I];H.moveTo(u.x+D,u.y),H.arc(u.x,u.y,D,0,w,!0),I++}else if(3===s){var u=Q[I+1];H.moveTo(u.x+D,u.y),H.arc(u.x,u.y,D,0,w,!0),I+=2}else if(4===s){var u=Q[I+2];H.moveTo(u.x+D,u.y),H.arc(u.x,u.y,D,0,w,!0),I+=3}}H.fill(),H.stroke(),H.beginPath(),I=0,H.strokeStyle=T,H.lineWidth=1,H.fillStyle=g;for(var L=0;F>L;L++){var s=k.get(L);if(1===s||2===s)I++;else if(3===s){var p=Q[I];H.moveTo(p.x+D,p.y),H.arc(p.x,p.y,D,0,w,!0),I+=2}else if(4===s){var j=Q[I],r=Q[I+1];H.moveTo(j.x+D,j.y),H.arc(j.x,j.y,D,0,w,!0),H.moveTo(r.x+D,r.y),H.arc(r.x,r.y,D,0,w,!0),I+=3}}if(H.fill(),H.stroke(),H.beginPath(),I=0,H.strokeStyle=Z,H.lineWidth=2,(M===n||d===n)&&i.$9l!=_){var u=Q[i.$9l];H.moveTo(u.x+D,u.y),H.arc(u.x,u.y,D,0,w,!0),H.stroke()}}}}),i.$87l&&x.sm().contains(i.$87l)){var ye,Hh=i.$87l,Bn=i.$88l,$j=x.getEditHelperSize(),rj=$j/2;if(x.isHelperEditable(Hh,"pointElevation"))if(Hh instanceof f){var xp=Hh.getPosition();ye=V.clone(Hh.getPoints().get(Bn)),ye=as({x:xp.x,y:xp.y},ye.x-xp.x,ye.y-xp.y,Hh.getRotation()),ye.x*=S,ye.y*=S,H.translate(ye.x,ye.y),V.drawImage(H,V.getImage("xeditinteractor_elevationIcon"),rj,-rj,$j,$j),H.translate(-ye.x,-ye.y),i._pointElevationHelperPoint={x:ye.x+$j,y:ye.y}}else if(Hh instanceof r){var Gh=sl(x.getDataUI(Hh),Hh.s("edge.points")),ye=V.clone(Gh.get(Bn));ye.x*=S,ye.y*=S,H.translate(ye.x,ye.y),V.drawImage(H,V.getImage("xeditinteractor_elevationIcon"),rj,-rj,$j,$j),H.translate(-ye.x,-ye.y),i._pointElevationHelperPoint={x:ye.x+$j,y:ye.y}}}H.restore(),i.$5l=0}},$89l:function(d,A,m,p){d.save();var c=this,B=c.gv,g=B.getEditHelperSize(),h=g/2;d.beginPath(),d.translate(m.x,m.y),d.rotate(A),V.drawImage(d,p,-h,-h,g,g),d.restore()},$85l:function(m,n,K){var G=this;G.$90l=K,G.$89l(m,n,K,V.getImage("xeditinteractor_elevationIcon"))},$86l:function(o,W,t){var r=this;r.$91l=t,r.$89l(o,W,t,V.getImage("xeditinteractor_tallIcon"))},$77l:function(p,x,N){var _=this;_.$68l=N,_.$89l(p,x,N,V.getImage("xeditinteractor_hostIcon"))},$80l:function(x,n,y){var o=this;o.$70l=y,o.$89l(x,n,y,V.getImage("xeditinteractor_edgeIcon"))},$81l:function($,r,O){var C=this;C.$71l=O,C.$89l($,r,O,V.getImage("xeditinteractor_removeIcon"))},$76l:function(H,T,x){var e=this;e.$69l=x,e.$89l(H,T,x,V.getImage("xeditinteractor_parentIcon"))},$84l:function(L,y,d,x,b){var h,w=this,z=w.gv,A=z.getZoom(),r=z.getEditHelperSize(),k=r/2;d.x*=A,d.y*=A,b&&(x?d.x-=k+5:d.x+=k+5),d.y-=r-2,x?(w.$82l=d,h=V.getImage("xeditinteractor_sourceIcon")):(w.$83l=d,h=V.getImage("xeditinteractor_targetIcon")),L.beginPath(),L.translate(d.x,d.y),V.drawImage(L,h,-k,-k,r,r),L.translate(-d.x,-d.y)},$44l:function(m,q,I){m.save();var G=this.gv.getZoom(),k=F(O(q.width,2)+O(q.height,2))/2*G+10,P=k,B=P+8,J=P+18,Y=I,H=q.x+q.width/2,e=q.y+q.height/2;m.translate(H*G,e*G),m.beginPath(),m.strokeStyle="rgb(150, 150, 150)";for(var d=0,W=0,A=0,s=0,U=0,y=0;360>y;y++)d=y*a/180,0===y%5&&(W=D(d)*P,A=u(d)*P,s=D(d)*B,U=u(d)*B,m.moveTo(W,A),m.lineTo(s,U)),0===y%45&&(W=D(d)*P,A=u(d)*P,s=D(d)*J,U=u(d)*J,m.moveTo(W,A),m.lineTo(s,U));m.stroke(),m.beginPath(),m.rotate(-E),m.beginPath(),m.fillStyle="rgba(255, 0, 0, 0.1)",m.strokeStyle="rgb(157, 157, 157)",m.moveTo(0,0),m.arc(0,0,J,0,I,!1),m.fill(),m.beginPath(),m.moveTo(0+J,0),m.arc(0,0,J,0,I,!1),m.stroke(),m.rotate(E),m.font="bold 12px Verdana, Arial";var g=20*u(Y),p=20*D(Y),Z=n(180*Y/a)+"°";m.textAlign="center",m.textBaseline="middle",m.beginPath();var x=m.measureText("365.°").width;m.fillStyle="white",m.rect(g-x/2,-p-10,x,20),m.fill(),m.beginPath(),m.fillStyle="rgb(79,79,79)",m.fillText(Z,g,-p),m.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);